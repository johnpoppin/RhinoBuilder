<html>
<head>

<title>RhinoBuilder 5</title>

<style>
	td		{font-family:Arial; font-weight:bold; font-size:10px; color:darkblue; vertical-align:middle;}
	button	{font-family:Arial; font-weight:bold; font-size:10px; color:darkblue;}
</style>

<script>

var masterTop = 50;
var rowHeight = 25;
var bumpDown = 0;
var buttonHeight = 20;
var buttonWidth = 80;
var buttonMargin = 10;
var buttonSpacing = 5;
var column1Margin = 10;
var column2Margin = 190;
var column3Margin = 330;
var column4Margin = 390;
var sliderBump = 5;
var buttonBump = 3;
var textAreaWidth = 50;
var textAreaHeight = 20;
var timeText = '';
var loadingMap = 0;
var volcanoCount = 0;
var volcanoXArray = new Array(100);
var volcanoYArray = new Array(100);
var canvasInitialized = 0;
var mouseIsDown = 0;
var drawingLand = 1;
var pgr = 0;
var ngr = 0;
var mainCycles = 0;
var specificBrowser = "Safari";
var errorText = "";
var drawingWater = 0;
var waterLevel = 0;
var settingWaterLevel = 0;
var addingBeaches = 0;
var riversRegular = 1;
var lavaFlowsCount = 0;
var riversCount = 0;
var riverX = 0;
var riverY = 0;
var oldRiverDirection = 0;

var preset1 = "";
var preset2 = "";
var preset3 = "";
var preset4 = "";
var preset5 = "";
var preset6 = "";

var settingPreset = 0;
var restoringPreset = 0;

//	var preset1Default = "D02000200300300100205001003080114008010035100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001110000000000000000000000000000000000000000000000011000000000110000000000000001000111000000000000000100000000011111000000000000111010100000000000000000001100001111110000010000011111110000000000000000000111000011111000000100000010111000000010000000000000000000011100000000000000001100000001110000000000000000001001000000010000000111000000111000000000000000000001110000000100000001100000001110000000000000000000011100000000000000111000000011110000000000000000000111100000000000011111000000111100000000000110001111111000000000000111110000000111000000000011100111100110000000000000111110000011100000000000110000110000110000000000001111111100111000000000001100001100001100000000000001111111111111000000000011000011000011000000000000011111111110000000000000000000000000000000000000000011101011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001100000000000000110000000000000000000000000000000011000000000000011110000000000000000001100000000000000000000000000111100000000000000000011000000000000000000000000000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111100000000000000000000100001000000000000000011001111100000000000000000011111110000000000000001110111111100000000000000101011111110000000000000001001111111110000000000000111100000110000000000000000010111111110000000000000110000000111100000000000000001110001110000000000011100000000111000000000000000001000001100000000001110000000000110000000000000000011000010000000000001100000000001100000000000000000110000100000000000011000011000011000000000001000001100001100000000001110000110000100000000000110000011000011000000000001100000000001100000000000100001110000100000000000001100000000110000000000001100010100000000000000000001000000001000000000000011111110000000000000000000011000000110000000000000000101000000000000110000000010000001000000000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
var preset2Default = "D05000500300300100302501003080108006008025100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000001111111000000000000000000000000000011000000000000011111111111110000000000000000000000110000000000000111111111111111111111100000000000001110000000000011111111111111111111111011000000001111000000000000111111111111111111111111100000000111100000000000001111111111111111111111110001000001111000000000000111111111111111111111111000111000111110000000000001111111001111111111111110001110111111000000000000011111110010111111111111100011111111110000000000000011111100001111111111111000111111111000000000000000111111100011111111111111011111111100000000000000001111111101111111111111111111111111100000000000000011111111111111111111111111111111111000000000000000011111111111111111111111111111111110000000000000000011111111111111111111111111111111000000000000000000111111111111111111111111111111100000000000000000000001111111111111111111111111110000000000000000000000000111111111111111111111111100000000000000000000000000000111111111111111111111000000000000000000000000000000111111111111110010110000000000000000000000000000000101111110001100000110000000000000000000000000000000001110000000000001110000000000000000000000000000000001000000000000001100000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111000000000000000000000000000000000000000000000011110000000000000000000000000000000000000000000000111100000000000000100100000000000000000000001000001101100000000000000000011000000000000000000000100010001000000000000000000000100000000000000000000111000001000000000000000000001100000000000000000000000000010000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
var preset3Default = "D05000500300300100205001003080115000008035100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000000000000000000000011110000000000000000000000000000001110000000000000111100000000000000000000000000001111110000000000000110000000000000000000000000001111111110000000000000000000001100000000000000111111111111110000000000000000001111100000000001111111111111111000000000000000000111111100000000111100011110011110000000000000000111111111000000000110000011000111100000000000000001111111110000000000100100110011110000000000000000011111111111100000001000001111111000000000000000000111111111111000000011000111111110000000000000000011111111110000000000111111111111100000000000000000111111111000000000001100011111110000000000000001111111111110000000000000000011111100000000000000001111111111110000000000000000000000000000000000000011111111111111000000000000001111110000000000000000111111111111110000000000000011111100000000000000000111111111110000000000000001111011100000000000000011111111111000000000001111111100011100000000000001111111111110000000000011111111000111000000000000011111111111000000000000111111110001110000000000000111111111110010000000000111111110111000000000000001111111111100000000000001111111111110000000000000001111111111000000000000011111111111100000000000001001111111111000000000000111111111111100000000000010011111111110000000000001111111111110000000000000100111111111100000000000011111111111100000000000000011111111111000000000000011111111111100000000000000111111111111000000000001111111111000000000000000001111111111100000000000111111111111000000000000000011111111111000000000001111111111110000000000000000111110011100000000000011111111111000000000000000001111000000000000000000001111111110000000000000000000000000000000000000000001111111100000000000000000000000000000000000000000011111100000000000000000000000000000100000000000000111100000000000000000000000000000000000000000000001000000000000000000000000000000000010000000000000010000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
var preset4Default = "D10001000300500050308000503080106008010030100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111100010000000100000000000000000000000000001000001111000000010001110010000000000000000111110110110011100000110011111111111111000000000011111111111101100100011111111111111111111100000001101111110010000000001111111111111111111100100000010011111100110000000001111111111111111001000000000000011111111100000011111111111111011111000000000000000111100111000000011001111111111111110000000000000011111111000000000111100111111111111100000000000000110111100000000000011111011111111101000000000000000111110000000000000000111111111111100100000000000011111100000000001110001111111111111010000000000000011000000000000011111111011111111110000000001000001110000000000001111111111101111111110000000000000001100100000000011111111111001101110000000001000000001100000000000111111110110011001100000000000000000001110000000001111111110000010011000000000000000000000011000000011111111110000000010010000000000000000001111000000010111111100000000000000000000000000000011111000000000111110000000010100000000000000000000011110000000001111100000000011000100000000000000001111111000000001110000000000000000110000000000000011111110000000111000000000000010000000000000000000011111000000001110000000000000001000000000000000000111110000000011110100000000000111000000000000000000101100000000111101000000000011111000000000000000001110000000001110000000000001111110000000000000000011100000000001100000000000011111100000000000000000110000000000010000000000000110111000000000000000001100000000000000000000000000001100001000000000000011000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000001111011111111100000000000000000000001111000001111111111111111111000000000000000000011111100000111111111111111111000000000000000000000000011111111111011001111010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
var preset5Default = "D05000500300400100205001003080111000004035100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010001100000000000000000000000000000000000000000000101001111000010000111000000000000000000000000000011100001100111110000111011001110000000000000000000111100111000011100000111100101000000000000000000011111111100001111000000110111101000000000000000001111111110001111111000011111111101110000000001100001111111100111111111001111111111111100000000001101111111110011111111100011111111110110010000000001111111111111111111111010011111101000101100000000011111111111111111111111110111111011111011000000000111111111111111111111111011111110111010110000000000011111111111111111111111111111100000001110000000000111111111111111111101111111110000000110100000000010111111111111111110001111100000000001101000000001100111111111111111011111110000000000001000000000001101111111111111110111011100000000010010000000000101111111111111111101100010000000000100000000000000111111111111111110000000000000000001110000000000001111111111111001000000000000000000011111100000000001111111111000000000000000000000000011111000000000001111111110000000000000000000000000011100000000000011111111000000000000000000000000000111100000001100111111111010000000000000000000000001110000000001101111111110000000000000000000000000011110000000000111111111111010000000000000000000000111000000000001111111111110000000000000000000000001010000000000001111111111111000000000000000000000010000000000000001111111111110000011000000000000000000000000000000001101111111000001111000000000000000000000000000000011011111110000110010000000010000000000000000000000100111111100001100000000001100000000000000000000001001111111000001000000000110000000000000000000001010011111111000001100000001100000000000000000000000000011111111000000000000001100000000100000000000000000011111100100000000000001000000001000000000000000000101111001000000000000000000000010000000000000000000111111000000000000000000001000100000000001000000001110100000000000010000000011001000000000010100000011101000000000001110000000011110000000000010000000011010000000000001000000000111000000000001100000000010100000000000000000000011011000000000011100000000100010000000000000000000100010000000000100000000000010001100011000001000001101100000000000010000000000001000011111000111000001110000000000001100000000000000100110010001111000110110000000000000000000000000001000110000010100001000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
var preset6Default = "D05000500300100300210001003060113002012030100000000000000000001100000000000000000000000000000000000000000000000011100001110000000000011100000000000000000000000000011110000111000000000000011000000000000000000000001111111111110000000011010000000111100000000000000011011111111100000000000000011101111110000001110000100011111111111001111111111111011111100000111110000100111111111110001111111111111111111000001111100000001111111100000111111111111111111110000011111000000011111111100011111111111111111111100000111110000000111110111110011111111111111111110000000111000000001111001111110111111111111111111100001001110000000001100011111111111111111111111111000000011110000000000000000111111111111111111111100000001111100000000100011111111111111111111111111110010111111000000011110111111111111111111111111111110001111110000000111101111111111111111111111111111111111111000000001111111111111111111111111111111111111111110000000001111111111111111111111111111111111111111100000000011111111111111111111111111111111111111110000000000111111111111111111111111111111111111011100000000000111111111111111111111111111111111110011000000000011111111111111111111111111111111111010100000000000111111111111111111111111111111111110000000000000001111111111111111111111111111111111111001100000000011111111110011111111101111111111111110011000000001111111111000011111111111111111111111001110000000011111111111000011111111111111111111111011000000000011111111111001111111111111111111111100110000000000111111111111111111111111111111111111000110000000001111111111111111111111111111011111100100100000000001111111111111111111111111110100000010011000000000011111111111111110111111111100011100110010000000000111111111111111100101111110001111100100000000000011111110000001111000011111111111111000010000000000111100000010000110001111111111111110001111000000001100000000000000001000111111111111110011110000000000000000000001000111111111111111111100011000000000000000000000011001111111111111111111110000000000000000000000000000111111111111111111111110000000000000000000000000001111111111111111111111111000000000011110000000000111111111111111110111111110000000001111110000001111111111111111111101011111110000000010000100001111111111111111111100010111101110000000110011000111111111111111111111100001110011100000000100100001111111011110111111111101111100010000000001001000011110000011001111111111011111100000000000010010000000000000000011110001100011111110010000000000000000000000000000000000000000000111111100000000000000000000000000000000000000000000011111000000000000000000000000000000000000000000000001111";

var preset1Default = "U010000100003001003031010030801114012012035100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111000000000000000000011111111110000000000001000000000000000000000000100000000000000000000000000000111110000000000000000011111111111100000000001110000000000000000000000111000000000000000000000000000001110000000000000000011111111111111000000001111100000000000000000000111110000000000000000000000000000010000000000000000011111111111111100000000011100000000000000000000111111000000000000000000000000000000000000000000000001111111111111110000000000100000000000000000000111111000000000000000000000000000000000000000000000000011111110111111000000000000000000000000000000111111000000000000000000000000000000000000000000000000000111111111111000000000000000000000000000000111111000000000000000000000000000000000000001100000000000000111111111100000000000000000000000000000011111000000000000000000000000000000000000011111000000000000001111111100000000000000000000000000000011111000000000001000000000000000000000000011111110000000000000011111110000000000000000000000000000011111100000000001110000000000000000000000011111110000000000000000111111000000000000000000000000000001111100000000001111100000000000000000000011111110000000000000000011111000000000000000000000000000001111110000000000111110000000000000000000011111110000000000100000011111100000000000010000000000000000111110000000000011111000000000000000000000111100000000000111000011111100000000000011100000000000000111111000000000001111100000000000000000000001000000000000111110001111100000000000011111000000000000011111000000000000111110000000000000000000000000000000000011111101111110000000000000111000000000000001111100000000000011111000000000000000000000000000000000000111110111110000000000000001000000000000001111110000000000011111100000000000000000000000000000000000111111111111000000000000000000000000000000111110000000000001111100000000000000000000000000000000000011111011111000000000000000000000000000000011111000000000000111110000000000000000000000000000000000001111101111100000000000000000000000000000001111100000000000011111100000000000000000000000000000000000111111111110000000000000000000000000000000111110000000000000111110000000000000000000000000000011110011111111111000000000000000000000000000000011111000000000000011111000000000000000000001100000011111111111111111110000000000000000000000000000001111100000000000001111100000000000000000001111000011111111111111111111000000000000000000000000000000111111000000000000111110000000000000000001111110000111111111111111111110000000000000000000000000000001111100000000000011111000000000000000001111110000001111111100000011111100000000000000000000000000000111111000000000011111000000000000000000111110000000001111100000000111110000000000000000000000000000011111111000000011111100000000000000000011111000000000111110000000001111100000000000000000000000000000111111111111111111100000000000000000011111100000000001111100000000111110000000000000000000000000000001111111111111111110000000000000000001111100000000000111110000000011111000000000000000000000000000000011111111111111110000000000000000000111110000000000011111000000001111110000000000000000000000000000000011111111111110000000000000000000011111100000000001111100000000011111000000000000000000000000000000000011111111110000000000000000000000111110000000000011100000000000111000000000000000000000000000000000000000000000000000000000000000000001110000000000000100000000000001000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001110000000000000000000000000000010000000000000000000000000000000000100000000000000000000000000000001111100000000000000000000000000011100000000000000000000000000000000111000000000000000000000000000000011100000000000000000000000000011111000000000000000000000000000000111110000000000000000000000000000000100000000000000000000000000000111000000000000000000000000000000001110000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000111110000000000000000000000000000000000000000000000000000000001111100000000000000000000000001111100011111100000000000000000000000000000000000000000000000000001111111111000000000000000000000001111111000111110000000000000000000000000000000000000000000000011111111111111110000000000000000000001111111000011111000000000000000000000000000000000000000000000011111111111111111100000000000000000000011111000001111100000000000000000000000000000000000000000000011111111111111111111000000000000000000000111000000111110111110000000000000000000000000000000000000011111111111110001111110000000000000000000000000000011111111111111000000000000000000000000000000000001111111110000000011111100000000000000000000000000001111111111111110000000000000000000000000000000001111100000000000000111110000000000000000000000000000111111111111111100000000000000000000000000000000111110000000000000011111100000000000000000000000000011111111111111110000000000000000000000000000000111110000000000000000111110000000000000000000000000001111111000111111000000000000000000000000000000111111000000000000000011111000000000000000000000000000111110000001111100000000000000000000000000000011111000000000000000001111100000000000000000000000000011111000000111110000000000000000000000000000011111100000000000000000111110000000000000000000000000001111100000011111000000000000000000000000000001111100000000000000000011111000000000000000000000000000111110000001111100000000000000000000000000000111110000000000000000001111100000000000000000000000000011111000000111110000000000000000000000000000011111000000000000000001111110000000000000000000000000001111100000011111000000000000000000000000000001111100000000000000000111110000000000000000000000000000111110000001111100000000000000000010000000000111110000000000000000011111000000000000000000000000000111110000000111110000000000000000011100000000011111000000000000000011111100000000000000000000000000011111000000011111100000000000000011111000000001111100000000000000001111100000000000000000000000000001111100000000111110000000000000000111000000000111111000000000000000111110000000000000000000000000000111110000000011111000000000000000001000000000001111100000000000000011111000000000000000000000000011111111000000001111100000000000000000000000000000111110000000000000011111100000000000000000000111111111111000000000111110000000000000000000000000000011111000000000000001111100000000000000000000111111111111100000000011111100000000000000000000000000001111100000000000001111110000000000000000000111111111111100000000000111110000000000000000000000000000111111000000000000111110000000000000000000001111111111100000000000001110000000000000000000000000000001111100000000000111111000000000000000000000011111100000000000000000010000000000000000000000000000000111110000000000011111000000000000000000000000000000000000000000000000000000000000000000000000000000011111000000000000111000000000000000000000000000000000000000000000000000000000000000000000000000000000111000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";

var checkboxX = 0;
var checkboxY = 0;
var checkboxSize = 5;
var checkboxDivText = '';

var doCheckForRunning = 1;
var doConstructCheckboxes = 0;
var doInstallCheckboxHTML = 0;
var doSetCheckboxElements = 0;
var doCheckAndLoadPreset1 = 0;
var doBuildWorld = 0;
var doCheckForContinentSelection = 0;
var doGatherValues = 0;
var doInitWorldArray = 0;
var doInitDisplayArray = 0;
var doSeedMountainRanges = 0;
var doSeedVolcano = 0;
var doPlotVolcanoes = 0;
var doGrowWorld = 0;
var doLoadDisplayArray = 0;
var doDrawTheWorld = 0;
var doCopyWorldArray = 0;
var doSetWaterLevel = 0;
var doAddShallows = 0;
var doAddBeaches = 0;
var doAddLavaFlows = 0;
var doAddRivers = 0;
var thisIsLava = 0;

var worldNotFull = 1;
var secondLevelGrown = 0;
var p = 0;
var q = 0;
var r = 0;
var s = 0;
var x = 0;
var y = 0;
var z = 0;
var confineHills = 1;
var checkingHillLocation = 0;
var edgeOfOcean = 0;

var mountainTopX = 0;
var mountainTopY = 0;

var mapArrayWorld = new Array(0);
var mapArrayDev = new Array(0);
var mapArrayDisplay = new Array(0);

var boxAddressArray = new Array(100);

	for (x=1;x<=100;x++)
	{
		boxAddressArray[x] = new Array(100);
	}
	for (y=1;y<=100;y++)
	{
		for (x=1;x<=100;x++)
		{
			boxAddressArray[x][y] = "ocean";
		}
	}

var growth = new Array(31);

	for (x=0;x<=31;x++)
	{
		growth[x] = 0-0;
	}

function constructCheckboxes()
{
	builderError.value = builderError.value + "\nConstructing checkboxes...";

	checkboxNumber = 0;

	for (checkboxCountB=1;checkboxCountB<=100;checkboxCountB++)
	{
		for (checkboxCountA=1;checkboxCountA<=100;checkboxCountA++)
		{
			checkboxNumber = checkboxNumber + 1;

			checkboxDivText = checkboxDivText + "<button type='button' id='checkboxx"+checkboxCountA+"y"+checkboxCountB+"' onMouseDown='changeX="+checkboxCountA+"; changeY="+checkboxCountB+"; mouseDown();' onMouseMove='changeX="+checkboxCountA+"; changeY="+checkboxCountB+"; mouseMove();' onMouseUp='mouseUp();' onMouseOver='changeX="+checkboxCountA+"; changeY="+checkboxCountB+"; mouseOver();' style='margin:0; border:0; padding:0; position:absolute; top:"+(checkboxY)+"px; left:"+(checkboxX)+"px; height:"+checkboxSize+"px; width:"+checkboxSize+"px;'></button>";

//			document.write("<button type='button' id='checkboxx"+checkboxCountA+"y"+checkboxCountB+"' onMouseDown='changeX="+checkboxCountA+"; changeY="+checkboxCountB+"; mouseDown();' onMouseMove='changeX="+checkboxCountA+"; changeY="+checkboxCountB+"; mouseMove();' onMouseUp='mouseUp();' onMouseOver='changeX="+checkboxCountA+"; changeY="+checkboxCountB+"; mouseOver();' style='margin:0; border:0; padding:0; position:absolute; top:"+(checkboxY)+"px; left:"+(checkboxX)+"px; height:"+checkboxSize+"px; width:"+checkboxSize+"px;'></button>");
//			document.getElementById("checkboxx"+checkboxCountA+"y"+checkboxCountB).style.background="url(boxblue10.png) no-repeat";

			checkboxX = checkboxX + checkboxSize;

			if (checkboxCountA==100 && checkboxCountB==100)
			{
				builderError.value = builderError.value + "Built checkbox inner HTML.";
				doInstallCheckboxHTML = 1;
			}
		}
		checkboxY = checkboxY + checkboxSize;
		checkboxX = 0;
	}
}

function installCheckboxHTML()
{
	document.getElementById('checkboxDiv').innerHTML = checkboxDivText;
	builderError.value = builderError.value + "\nInstalled checkbox inner HTML.";
	doSetCheckboxElements = 1;
}

function setCheckboxElements()
{
	for (checkboxCountB=1;checkboxCountB<=100;checkboxCountB++)
	{
		for (checkboxCountA=1;checkboxCountA<=100;checkboxCountA++)
		{
			document.getElementById("checkboxx"+checkboxCountA+"y"+checkboxCountB).style.background="url(boxblue10.png) no-repeat";
			if (checkboxCountA==100 && checkboxCountB==100)
			{
				builderError.value = builderError.value + "\nSet checkbox elements.";
				doCheckAndLoadPreset1 = 1;
			}
		}
	}
}

function showWidth()					{widthTextArea.value=widthSlider.value;}
function showHeight()					{heightTextArea.value=heightSlider.value;}
//function showElevations()				{elevationsTextArea.value=elevationsSlider.value;//	setGrowthCurve();}
function showNumMtnRanges()				{numMtnRangesTextArea.value=numMtnRangesSlider.value;}
function showMaxMtnLength()				{maxMtnLengthTextArea.value=maxMtnLengthSlider.value;}
//function showMaxMtnGirth()				{maxMtnGirthTextArea.value=maxMtnGirthSlider.value;//	setGrowthCurve();}
function showNumHillRanges()			{numHillRangesTextArea.value=numHillRangesSlider.value;}
function showMaxHillLength()			{maxHillLengthTextArea.value=maxHillLengthSlider.value;}
function showMaxHillGirth()				{maxHillGirthTextArea.value=maxHillGirthSlider.value;}
function showHillCurvyness()			{hillCurvynessTextArea.value=hillCurvynessSlider.value;}
function showLandSlope()				{landSlopeTextArea.value=landSlopeSlider.value;}
function showNumVolcanoes()				{numVolcanoesTextArea.value=numVolcanoesSlider.value;}
function showMaxVolcanoSize()			{maxVolcanoSizeTextArea.value=maxVolcanoSizeSlider.value;}
function showLandUniformity()			{landUniformityTextArea.value=landUniformitySlider.value;}
function showBrushSize()				{brushSizeTextArea.value=brushSizeSlider.value;}

function gatherBuilderValues()
{
	mapSizeX = widthTextArea.value;
	mapSizeY = heightTextArea.value;
	numMtnRanges = numMtnRangesTextArea.value;
	maxMtnLength = maxMtnLengthTextArea.value;
	maxMtnGirth = maxMtnGirthTextArea.value;
	numHillRanges = numHillRangesTextArea.value;
	maxHillLength = maxHillLengthTextArea.value;
	maxHillGirth = maxHillGirthTextArea.value;
	hillCurvyness = hillCurvynessTextArea.value;
	landSlope = landSlopeTextArea.value;
	numVolcanoes = numVolcanoesTextArea.value;
	numVolcanoesStart = numVolcanoesTextArea.value;
	maxVolcanoSize = maxVolcanoSizeTextArea.value;
	landUniformity = landUniformityTextArea.value;
}

function checkAndLoadPreset1()
{
	builderError.value += "\nGot to checkAndLoadPreset1();";
	if (specificBrowser=="Safari" || specificBrowser=="Chrome" || specificBrowser=="Opera")
	{
		if (localStorage.preset41 == null)
		{
			localStorage.preset41 = preset1Default;
		}
		if (localStorage.preset42 == null)
		{
			localStorage.preset42 = preset2Default;
		}
		if (localStorage.preset43 == null)
		{
			localStorage.preset43 = preset3Default;
		}
		if (localStorage.preset44 == null)
		{
			localStorage.preset44 = preset4Default;
		}
		if (localStorage.preset45 == null)
		{
			localStorage.preset45 = preset5Default;
		}
		if (localStorage.preset46 == null)
		{
			localStorage.preset46 = preset6Default;
		}
		if (localStorage.preset41.substr(0,1) == "U")
		{
			presetString = localStorage.preset41;
			builderError.value += "\nPreset 1 LOADED.";
			builderError.scrollTop = builderError.scrollHeight;
		}
		else
		{
			presetString = preset1Default;
			builderError.value += "\nPreset 1 [default] LOADED.";
			builderError.scrollTop = builderError.scrollHeight;
		}
		parseAndInstallPresetValues();
	}
	else
	{
		presetString = preset1Default;
	}
}

function parseAndInstallPresetValues()
{

//			  111111111122222222223333333333444444444455555555556666666666
//	01234567890123456789012345678901234567890123456789012345678901234567890
//	D05000500300300100302501003080108006008025
//	-||||----||---|||--|||---||---|||---|||---
//	U0500050030030010030250100308010800600802500000000000000000000100000000

//	U1000010000mmmRRRgg###lllGGccc1sssvvvVVVuuu
//	 12345678901234567890123456789012345678901234567890123456789012345678901234567890
//	          1         2         3         4         5

	widthTextArea.value = parseInt(presetString.substr(1,5),10);
	widthSlider.value = widthTextArea.value;
	showWidth();

	heightTextArea.value = parseInt(presetString.substr(6,5),10);
	heightSlider.value = heightTextArea.value;
	showHeight();

	numMtnRangesTextArea.value = parseInt(presetString.substr(11,3),10);
	numMtnRangesSlider.value = numMtnRangesTextArea.value;

	maxMtnLengthTextArea.value = parseInt(presetString.substr(14,3),10);
	maxMtnLengthSlider.value = maxMtnLengthTextArea.value;

	maxMtnGirthTextArea.value = parseInt(presetString.substr(17,2),10);
	maxMtnGirthSlider.value = maxMtnGirthTextArea.value;

	numHillRangesTextArea.value = parseInt(presetString.substr(19,3),10);
	numHillRangesSlider.value = numHillRangesTextArea.value;

	maxHillLengthTextArea.value = parseInt(presetString.substr(22,3),10);
	maxHillLengthSlider.value = maxHillLengthTextArea.value;

	maxHillGirthTextArea.value = parseInt(presetString.substr(25,2),10);
	maxHillGirthSlider.value = maxHillGirthTextArea.value;

	hillCurvynessTextArea.value = parseInt(presetString.substr(27,3),10);
	hillCurvynessSlider.value = hillCurvynessTextArea.value;

	confineHills = parseInt(presetString.substr(30,1),10);

	landSlopeTextArea.value = parseInt(presetString.substr(31,3),10);
	landSlopeSlider.value = landSlopeTextArea.value;

	numVolcanoesTextArea.value = parseInt(presetString.substr(34,3),10);
	numVolcanoesSlider.value = numVolcanoesTextArea.value;

	maxVolcanoSizeTextArea.value = parseInt(presetString.substr(37,3),10);
	maxVolcanoSizeSlider.value = maxVolcanoSizeTextArea.value;

	landUniformityTextArea.value = parseInt(presetString.substr(40,3),10);
	landUniformitySlider.value = landUniformityTextArea.value;

	z = 63;

	for (y=1;y<=100;y++)
	{
		for (x=1;x<=100;x++)
		{
			if (presetString.substr(z,1) == "1")
			{
				document.getElementById("checkboxx"+(x)+"y"+(y)).style.background="url(boxgreen10.png) no-repeat";
				boxAddressArray[x][y] = "land";
			}
			else
			{
				document.getElementById("checkboxx"+(x)+"y"+(y)).style.background="url(boxblue10.png) no-repeat";
				boxAddressArray[x][y] = "ocean";
			}

			z++;
		}
	}

	setGrowthCurve();
}

function setPreset()
{
	document.getElementById("buttonSetPreset").style.display="none";
	document.getElementById("buttonCancelSetPreset").style.display="block";
	buttonRestorePreset.disabled=true;
	buttonDrawLand.disabled=true;
	buttonEraseLand.disabled=true;
	buttonSelectAll.disabled=true;
	buttonClearAll.disabled=true;
	buttonRandomLand.disabled=true;
	buttonPreset1.disabled=false;
	buttonPreset2.disabled=false;
	buttonPreset3.disabled=false;
	buttonPreset4.disabled=false;
	buttonPreset5.disabled=false;
	buttonPreset6.disabled=false;
	settingPreset = 1;
	builderError.value += "\nSET Preset...";
	builderError.scrollTop = builderError.scrollHeight;
}

function restorePreset()
{
	document.getElementById("buttonRestorePreset").style.display="none";
	document.getElementById("buttonCancelRestorePreset").style.display="block";
	buttonSetPreset.disabled=true;
	buttonDrawLand.disabled=true;
	buttonEraseLand.disabled=true;
	buttonSelectAll.disabled=true;
	buttonClearAll.disabled=true;
	buttonRandomLand.disabled=true;
	buttonPreset1.disabled=false;
	buttonPreset2.disabled=false;
	buttonPreset3.disabled=false;
	buttonPreset4.disabled=false;
	buttonPreset5.disabled=false;
	buttonPreset6.disabled=false;
	restoringPreset = 1;
	builderError.value += "\nRESTORE Preset...";
	builderError.scrollTop = builderError.scrollHeight;
}

function setThePreset()
{
	if (settingPreset==1)
	{
		gatherBuilderValues();
		if (errorText == "")
		{
			assemblePresetString();
			if (activePreset==1)				{localStorage.preset41 = presetString;}
			else if (activePreset==2)			{localStorage.preset42 = presetString;}
			else if (activePreset==3)			{localStorage.preset43 = presetString;}
			else if (activePreset==4)			{localStorage.preset44 = presetString;}
			else if (activePreset==5)			{localStorage.preset45 = presetString;}
			else if (activePreset==6)			{localStorage.preset46 = presetString;}
			builderError.value += "\nPreset "+activePreset+" SET.";
			builderError.value += "\nPreset string: " + presetString;
			builderError.scrollTop = builderError.scrollHeight;
			settingPreset = 0;
		}
		else
		{
			builderError.value += "\n[*** ERROR ***]" + errorText;
			builderError.scrollTop = builderError.scrollHeight;
			errorText = "";
		}
	}
	else if (restoringPreset==1)
	{
		if (activePreset==1)				{presetString = preset1Default; localStorage.preset41 = presetString;}
		else if (activePreset==2)			{presetString = preset2Default; localStorage.preset42 = presetString;}
		else if (activePreset==3)			{presetString = preset3Default; localStorage.preset43 = presetString;}
		else if (activePreset==4)			{presetString = preset4Default; localStorage.preset44 = presetString;}
		else if (activePreset==5)			{presetString = preset5Default; localStorage.preset45 = presetString;}
		else if (activePreset==6)			{presetString = preset6Default; localStorage.preset46 = presetString;}
		parseAndInstallPresetValues();
		builderError.value += "\nPreset "+activePreset+" RESTORED.";
		builderError.scrollTop = builderError.scrollHeight;
		restoringPreset = 0;
	}
	else
	{
		loadPresetValues();
		if (presetString.substr(0,1) == "U")
		{
			builderError.value += "\nPreset "+activePreset+" LOADED.";
		}
		else
		{
			if (activePreset==1)
			{
				presetString = preset1Default;
			}
			else if (activePreset==2)
			{
				presetString = preset2Default;
			}
			else if (activePreset==3)
			{
				presetString = preset3Default;
			}
			else if (activePreset==4)
			{
				presetString = preset4Default;
			}
			else if (activePreset==5)
			{
				presetString = preset5Default;
			}
			else if (activePreset==6)
			{
				presetString = preset6Default;
			}
			builderError.value += "\nPreset "+activePreset+" [default] LOADED.";
		}
		parseAndInstallPresetValues();
//		builderError.value += "\nPreset string: " + presetString;
		builderError.scrollTop = builderError.scrollHeight;
	}
	restoreDisplay();
}

function restoreDisplay()
{
	document.getElementById("buttonSetPreset").style.display="block";
	document.getElementById("buttonCancelSetPreset").style.display="none";
	document.getElementById("buttonRestorePreset").style.display="block";
//	document.getElementById("buttonCancelRestorePreset").style.display="none";
	buttonSetPreset.disabled=false;
	buttonRestorePreset.disabled=false;
	if (drawingLand==0)		{buttonDrawLand.disabled=false;}
	if (drawingLand==1)		{buttonEraseLand.disabled=false;}
	buttonSelectAll.disabled=false;
	buttonClearAll.disabled=false;
	buttonRandomLand.disabled=false;

	if (activePreset==1)			{buttonPreset1.disabled=true;}
	else							{buttonPreset1.disabled=false;}

	if (activePreset==2)			{buttonPreset2.disabled=true;}
	else							{buttonPreset2.disabled=false;}

	if (activePreset==3)			{buttonPreset3.disabled=true;}
	else							{buttonPreset3.disabled=false;}

	if (activePreset==4)			{buttonPreset4.disabled=true;}
	else							{buttonPreset4.disabled=false;}

	if (activePreset==5)			{buttonPreset5.disabled=true;}
	else							{buttonPreset5.disabled=false;}

	if (activePreset==6)			{buttonPreset6.disabled=true;}
	else							{buttonPreset6.disabled=false;}
}

function assemblePresetString()
{
//	mapSizeX

	if (mapSizeX > 9999)			{presetString = "U" + mapSizeX.toString();}
	else							{presetString = "U0" + mapSizeX.toString();}

//	mapSizeY

	if (mapSizeY > 9999)			{presetString += mapSizeY.toString();}
	else							{presetString += "0" + mapSizeY.toString();}

//	numMtnRanges

	if (numMtnRanges > 99)			{presetString += numMtnRanges.toString();}
	else if (numMtnRanges > 9 &&
			 numMtnRanges < 100)	{presetString += "0" + numMtnRanges.toString();}
	else							{presetString += "00" + numMtnRanges.toString();}

//	maxMtnLength

	if (maxMtnLength > 99)			{presetString += maxMtnLength.toString();}
	else if (maxMtnLength > 9 &&
			 maxMtnLength < 100)	{presetString += "0" + maxMtnLength.toString();}
	else							{presetString += "00" + maxMtnLength.toString();}

//	maxMtnGirth

	if (maxMtnGirth > 9)			{presetString += maxMtnGirth.toString();}
	else							{presetString += "0" + maxMtnGirth.toString();}

//	numHillRanges

	if (numHillRanges > 99)			{presetString += numHillRanges.toString();}
	else if (numHillRanges > 9 &&
			 numHillRanges < 100)	{presetString += "0" + numHillRanges.toString();}
	else							{presetString += "00" + numHillRanges.toString();}

//	maxHillLength

	if (maxHillLength > 99)			{presetString += maxHillLength.toString();}
	else if (maxHillLength > 9 &&
			 maxHillLength < 100)	{presetString += "0" + maxHillLength.toString();}
	else							{presetString += "00" + maxHillLength.toString();}

//	maxHillGirth

	if (maxHillGirth > 9)			{presetString += maxHillGirth.toString();}
	else							{presetString += "0" + maxHillGirth.toString();}

//	hillCurvyness

	if (hillCurvyness > 99)			{presetString += hillCurvyness.toString();}
	else if (hillCurvyness > 9 &&
			 hillCurvyness < 100)	{presetString += "0" + hillCurvyness.toString();}
	else							{presetString += "00" + hillCurvyness.toString();}

//	Confined or Wild and Free?

	if (confineHills==1)			{presetString += "1";}
	else							{presetString += "0";}

//	landSlope

	if (landSlope > 99)             {presetString += landSlope.toString();}
	else                            {presetString += "0" + landSlope.toString();}

//	numVolcanoes

	if (numVolcanoes > 99)			{presetString += numVolcanoes.toString();}
	else if (numVolcanoes > 9 &&
			 numVolcanoes < 100)	{presetString += "0" + numVolcanoes.toString();}
	else							{presetString += "00" + numVolcanoes.toString();}

//	maxVolcanoSize

	if (maxVolcanoSize > 99)		{presetString += maxVolcanoSize.toString();}
	else if (maxVolcanoSize > 9 &&
			 maxVolcanoSize < 100)	{presetString += "0" + maxVolcanoSize.toString();}
	else							{presetString += "00" + maxVolcanoSize.toString();}

//	landUniformity

	if (landUniformity > 99)		{presetString += landUniformity.toString();}
	else if (landUniformity > 9 &&
			 landUniformity < 100)	{presetString += "0" + landUniformity.toString();}
	else							{presetString += "00" + landUniformity.toString();}

//	confineHills

	presetString += confineHills.toString();

	presetString = presetString + "0000000000000000000";

//	READ IN CHECKBOX Array

	for (y=1;y<=100;y++)
	{
		for (x=1;x<=100;x++)
		{
			if (boxAddressArray[x][y]=="land")
			{
				presetString = presetString + "1";
			}
			else
			{
				presetString = presetString + "0";
			}
		}
	}

//	builderError.value += "\nPreset string: " + presetString;
//	builderError.scrollTop = builderError.scrollHeight;
}

function checkForRunning()
{
	doCheckForRunning = 0;
	builderError.value = builderError.value + "\nMain() is running...";
	doConstructCheckboxes = 1;
}

//	#################################
//	#################################
//	##                             ##
//	##   #   #   #   ##### #   #   ##
//	##   ## ##  # #    #   ##  #   ##
//	##   # # # #####   #   # # #   ##
//	##   #   # #   #   #   #  ##   ##
//	##   #   # #   # ##### #   #   ##
//	##                             ##
//	#################################
//	#################################

function main()
{
	setTimeout("main();",100);

	if (doCheckForRunning==1)
	{
		checkForRunning();
	}

	//	CONSTRUCT CHECKBOXES

	if (doConstructCheckboxes==1)
	{
		doConstructCheckboxes = 0;
		constructCheckboxes();
	}

	if (doInstallCheckboxHTML==1)
	{
		doInstallCheckboxHTML = 0;
		installCheckboxHTML();
	}

	if (doSetCheckboxElements==1)
	{
		doSetCheckboxElements = 0;
		setCheckboxElements();
	}

	//	CHECK AND LOAD PRESET1

	if (doCheckAndLoadPreset1==1)
	{
		doCheckAndLoadPreset1 = 0;
		checkAndLoadPreset1();
	}

	//	START BUILD

	if (doBuildWorld==1)
	{
		getTime();
		doBuildWorld = 0;
		closeAllDivs();
		document.getElementById("divConstructor").style.display="block";
		constructorError.value = "[" + timeText + "] - Starting build...";
		doCheckForContinentSelection = 1;
	}

	//	CHECK FOR CONTINENT SELECTION	------------------------------------------------------------------------

	else if (doCheckForContinentSelection==1)
	{

//	##### NEEDS WORK #####

		getTime();
		doCheckForContinentSelection = 0;
		constructorError.value = constructorError.value + "\n[" + timeText + "] - Checking continental selection(s)...";
		doCheckForContinentSelection = 2;
	}
	else if (doCheckForContinentSelection==2)
	{
		doCheckForContinentSelection = 0;
		checkForContinentSelection();
	}
	else if (doCheckForContinentSelection==3)
	{
		builderError.value = builderError.value + "\nGot to doCheckForContinentSelection==3...";
		doCheckForContinentSelection = 0;
		if (continentsAreSelected==1)
		{
			constructorError.value = constructorError.value + "Values good...";
			doGatherValues = 1;
		}
		else
		{
			constructorError.value = constructorError.value + "\n\n[*** ERROR ***]: No continents selected!";
		}
	}

	//	GATHER BUILDER VALUES	------------------------------------------------------------------------

	else if (doGatherValues==1)
	{
		getTime();
		doGatherValues = 0;
		constructorError.value = constructorError.value + "\n[" + timeText + "] - Gathering builder values...";
		doGatherValues = 2;
	}
	else if (doGatherValues==2)
	{
		doGatherValues = 0;
		gatherBuilderValues();
		doGatherValues = 3;
	}
	else if (doGatherValues==3)
	{
		doGatherValues = 0;
		constructorError.value = constructorError.value + "Gathered...";
		doInitWorldArray = 1;
	}

	//	INITIALIZE WORLD ARRAY	------------------------------------------------------------------------

	else if (doInitWorldArray==1)
	{
		getTime();
		doInitWorldArray = 0;
		constructorError.value = constructorError.value + "\n[" + timeText + "] - Initializing world arrays...";
		doInitWorldArray = 2;
	}
	else if (doInitWorldArray==2)
	{
		doInitWorldArray = 0;
		initWorldArray();
	}
	else if (doInitWorldArray==3)
	{
		doInitWorldArray = 0;
		getTime();
		constructorError.value = constructorError.value + "\n[" + timeText + "] - World Arrays initialized...";
		doInitDisplayArray = 1;
//		constructorError.value = constructorError.value + "\ndoSeedMountainRanges = "+doSeedMountainRanges;
	}

	//	INITIALIZE DISPLAY ARRAY	------------------------------------------------------------------------

	else if (doInitDisplayArray==1)
	{
		doInitDisplayArray = 0;
		getTime();
		constructorError.value = constructorError.value + "\n[" + timeText + "] - Initializing Display Array...";
		initDisplayArray();
	}
	else if (doInitDisplayArray==2)
	{
		doInitDisplayArray = 0;
		constructorError.value = constructorError.value + "\n[" + timeText + "] - Display Array initialized...";
		doSeedMountainRanges = 1;
	}

	//	SEED MOUNTAIN RANGES	------------------------------------------------------------------------

	else if (doSeedMountainRanges==1)
	{
		doSeedMountainRanges = 0;
//		constructorError.value = constructorError.value + "\nGot to doSeedMountainRanges.";
		getTime();
		constructorError.value = constructorError.value + "\n[" + timeText + "] - Seeding mountain ranges...";
		if (numMtnRanges==0)
		{
			doGrowWorld = 1;
		}
		else
		{
			doSeedMountainRanges = 2;
		}
	}
	else if (doSeedMountainRanges==2)
	{
		doSeedMountainRanges = 0;
		seedMountainRanges();
	}
	else if (doSeedMountainRanges==3)
	{
		doSeedMountainRanges = 0;
		constructorError.value = constructorError.value + "Mountains seeded...";
		doSeedVolcano = 1;
	}

	//	SEED VOLCANOES	------------------------------------------------------------------------

	else if (doSeedVolcano==1)
	{
		doSeedVolcano = 0;
		getTime();
		constructorError.value = constructorError.value + "\n[" + timeText + "] - Seeding volcanoes...";
		if (numVolcanoes > 0)
		{
			doSeedVolcano = 2;
		}
		else
		{
			getTime();
			constructorError.value += "\n[" + timeText + "] - [No volcanoes.]";
			constructorError.value += "\n[" + timeText + "] - [Level 1 created.]";
			constructorError.value += "\n[" + timeText + "] - Growing world...";
			constructorError.scrollTop = constructorError.scrollHeight;
			z = 2;
			doGrowWorld = 1;
		}
	}
	else if (doSeedVolcano==2)
	{
//		constructorError.value += "\nFound doSeedVolcano = 2.";
//		constructorError.scrollTop = constructorError.scrollHeight;
		doSeedVolcano = 0;
		if (numVolcanoes==0)
		{
			doSeedVolcano = 3;
		}
		else
		{
//			constructorError.value += "\nMore volcanoes are needed.";
//			constructorError.scrollTop = constructorError.scrollHeight;
			seedVolcano();
		}
	}
	else if (doSeedVolcano==3)
	{
		doSeedVolcano = 0;
		getTime();
		constructorError.value = constructorError.value + "\n[" + timeText + "] - Volcanoes seeded... z = "+z;
		z=2;
		doGrowWorld = 1;
	//	doPlotVolcanoes = 1;
	}
	else if (doPlotVolcanoes==1)
	{
		doPlotVolcanoes = 2;
		drawTheWorld();
	}

	//	GROW WORLD	------------------------------------------------------------------------

	else if (doGrowWorld==1)
	{
		doGrowWorld = 0;
		getTime();
		constructorError.value = constructorError.value + "\n[" + timeText + "] - Growing world... z = "+z;
		constructorError.scrollTop = constructorError.scrollHeight;
		growALevel();
	}

	//	LOAD DISPLAY ARRAY	------------------------------------------------------------------------

	else if (doLoadDisplayArray==1)
	{
		doLoadDisplayArray = 0;
		getTime();
		if (drawingWater==0)
		{
			constructorError.value = constructorError.value + "\n[" + timeText + "] - Loading Display Array...";
			constructorError.value = constructorError.value + "\n[" + timeText + "] - Map size is "+mapSizeX+"x"+mapSizeY+"...";
			constructorError.value = constructorError.value + "\n[" + timeText + "] - Rendering display to 1000x1000...";
		}
		else
		{
			constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Loading Display Array...";
			constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Map size is "+mapSizeX+"x"+mapSizeY+"...";
			constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Rendering display to 1000x1000...";
		}
		constructorError.scrollTop = constructorError.scrollHeight;
		loadDisplayArray();
	}
	else if (doLoadDisplayArray==2)
	{
		doLoadDisplayArray = 0;
		getTime();
		if (drawingWater==0)
		{
			constructorError.value = constructorError.value + "Loaded.";
		}
		else
		{
			constructor2Error.value = constructor2Error.value + "Loaded.";
		}
		constructorError.scrollTop = constructorError.scrollHeight;
		doDrawTheWorld = 1;
	}

	//	DRAW THE WORLD	------------------------------------------------------------------------

	else if (doDrawTheWorld==1)
	{
		doDrawTheWorld = 0;
		getTime();
		if (drawingWater==0)
		{
			constructorError.value = constructorError.value + "\n[" + timeText + "] - Drawing the world...";
		}
		else
		{
			constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Drawing the world...";
		}
		constructorError.scrollTop = constructorError.scrollHeight;
		doDrawTheWorld = 2;
	}
	else if (doDrawTheWorld==2)
	{
		doDrawTheWorld = 0;
		drawTheWorld();
	}
	else if (doDrawTheWorld==3)
	{
		doDrawTheWorld = 0;
		getTime();
		if (drawingWater==0)
		{
			constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Finished drawing.";
		}
		else
		{
			constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Finished drawing.";
		}
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
		document.getElementById("buttonContinueFromConstructor").style.display="block";
	}

	//	COPY WORLD ARRAY ------------------------------------------------------------------------

	else if (doCopyWorldArray==1)
	{
		doCopyWorldArray = 0;
		getTime();
		constructorError.value = constructorError.value + "\n[" + timeText + "] - Creating development world array...";
		constructorError.scrollTop = constructorError.scrollHeight;
		doCopyWorldArray = 2;
	}
	else if (doCopyWorldArray==2)
	{
		doCopyWorldArray = 0;
		duplicateWorldArray();
	}
	else if (doCopyWorldArray==3)
	{
		doCopyWorldArray = 0;
		getTime();
		constructorError.value = constructorError.value + "Created.";
		constructorError.scrollTop = constructorError.scrollHeight;
		doLoadDisplayArray = 1;
	}

	//	SET WATER LEVEL ------------------------------------------------------------------------

	else if (doSetWaterLevel==1)
	{
		doSetWaterLevel = 0;
		getTime();
		constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Setting water level...";
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
		doSetWaterLevel = 2;
	}
	else if (doSetWaterLevel==2)
	{
		doSetWaterLevel = 0;
		setWaterLevel();
	}
	else if (doSetWaterLevel==3)
	{
		doSetWaterLevel = 0;
		getTime();
		constructor2Error.value = constructor2Error.value + "Set.";
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
		doLoadDisplayArray = 1;
	}

	//	ADD BEACHES ------------------------------------------------------------------------

	else if (doAddBeaches==1)
	{
		doAddBeaches = 0;
		getTime();
		constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Adding beaches...";
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
		doAddBeaches = 2;
	}
	else if (doAddBeaches==2)
	{
		doAddBeaches = 0;
		addBeaches();
	}
	else if (doAddBeaches==3)
	{
		doAddBeaches = 0;
		getTime();
		constructor2Error.value = constructor2Error.value + "Added.";
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
		doLoadDisplayArray = 1;
	}

	//	ADD LAVA FLOWS ------------------------------------------------------------------------

	else if (doAddLavaFlows==1)
	{
		doAddLavaFlows = 0;
		getTime();
		constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Adding lava flows...";
		lavaFlowsCount = lavaFlowsTextArea.value
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
		doAddLavaFlows = 2;
	}
	else if (doAddLavaFlows==2)
	{
		doAddLavaFlows = 0;
		addLavaFlows();
	}
	else if (doAddLavaFlows==3)
	{
		doAddLavaFlows = 0;
		getTime();
		constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Fattening lava flows...";
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
		doAddLavaFlows = 4;
	}
	else if (doAddLavaFlows==4)
	{
	//	constructor2Error.value = constructor2Error.value + "\nGot here.";
		doAddLavaFlows = 0;
		thisIsLava = 1;
		fattenRivers();
		thisIsLava = 0;
		doAddLavaFlows = 5;
	}
	else if (doAddLavaFlows==5)
	{
		doAddLavaFlows = 0;
		getTime();
		constructor2Error.value = constructor2Error.value + "Done.";
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
		doLoadDisplayArray = 1;
	}

	//	ADD RIVERS ------------------------------------------------------------------------

	else if (doAddRivers==1)
	{
		doAddRivers = 0;
		getTime();
		constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Adding rivers...";
		riversCount = riversTextArea.value
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
		doAddRivers = 2;
	}
	else if (doAddRivers==2)
	{
	//	constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Adding rivers...2";
		doAddRivers = 0;
		addRivers();
	}
	else if (doAddRivers==3)
	{
		doAddRivers = 0;
		getTime();
		constructor2Error.value = constructor2Error.value + "\n[" + timeText + "] - Fattening rivers...";
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
		doAddRivers = 4;
	}
	else if (doAddRivers==4)
	{
	//	constructor2Error.value = constructor2Error.value + "\nGot here.";
		doAddRivers = 0;
		fattenRivers();
		doAddRivers = 5;
	}
	else if (doAddRivers==5)
	{
		doAddRivers = 0;
		getTime();
		constructor2Error.value = constructor2Error.value + "Done.";
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
		doLoadDisplayArray = 1;
	}
}

function seedHillRanges()
{

/*

	hillCurvynessFactor = 0 then straight
	hillCurvynessFactor = 100 then totally curvy

	1	2	3


	4		5


	6	7	8

	turn left, turn right or go straight

	if old direction = 1 then 1, 4 or 2
	if old direction = 2 then 2, 1 or 3
	if old direction = 3 then 3, 2 or 5
	if old direction = 4 then 4, 6 or 1
	if old direction = 5 then 5, 3 or 8
	if old direction = 6 then 6, 7 or 4
	if old direction = 7 then 7, 8 or 6
	if old direction = 8 then 8, 5 or 7

*/

	if (z > 2)
	{
//		numHillRanges = (numHillRanges * hillMultiplierFactor[z-2]);
		for (v=1;v<=numHillRanges;v++)
		{
			goodSeedLocation = 0;
			var hillSeedTrys = 0;

			while (goodSeedLocation == 0 && hillSeedTrys < 10000)
			{
				hillSeedTrys = hillSeedTrys + 1;

				hillRangeX = Math.floor(Math.random()*mapSizeX)+1;
				hillRangeY = Math.floor(Math.random()*mapSizeY)+1;

				mountainTopX = hillRangeX;
				mountainTopY = hillRangeY;

				checkingHillLocation = 1;
				checkSeedLocation();
			}

			checkingHillLocation = 2;

			if (goodSeedLocation == 1)
			{
				mapArrayWorld[hillRangeX][hillRangeY] = z;

				oldDirection = Math.floor(Math.random()*8)+1;

				realHillLength = Math.round(Math.floor(Math.random()*(((maxHillLength / 100) * mapSizeX) / 2)) + (Math.random()*(((maxHillLength / 100) * mapSizeX) / 2)) + 1);

//				constructorError.value += "\nrealHillLength: "+realHillLength;
//				constructorError.scrollTop = constructorError.scrollHeight;

//				for (asd=1;asd<=1;asd++)
				for (asd=1;asd<=realHillLength;asd++)
				{
					randomNumber = Math.floor(Math.random()*100)+1;
					if (randomNumber <= hillCurvyness)
					{
						//	CURVY!

						randomNumber = Math.floor(Math.random()*100)+1;
						if (randomNumber < 51)
						{
							//	GO LEFT!

							if      (oldDirection == 1)		{newDirection = 4;}
							else if (oldDirection == 2)		{newDirection = 1;}
							else if (oldDirection == 3)		{newDirection = 2;}
							else if (oldDirection == 4)		{newDirection = 6;}
							else if (oldDirection == 5)		{newDirection = 3;}
							else if (oldDirection == 6)		{newDirection = 7;}
							else if (oldDirection == 7)		{newDirection = 8;}
							else if (oldDirection == 8)		{newDirection = 5;}
						}
						else
						{
							//	GO RIGHT!

							if      (oldDirection == 1)		{newDirection = 2;}
							else if (oldDirection == 2)		{newDirection = 3;}
							else if (oldDirection == 3)		{newDirection = 5;}
							else if (oldDirection == 4)		{newDirection = 1;}
							else if (oldDirection == 5)		{newDirection = 8;}
							else if (oldDirection == 6)		{newDirection = 4;}
							else if (oldDirection == 7)		{newDirection = 6;}
							else if (oldDirection == 8)		{newDirection = 7;}
						}
					}
					else
					{
						//	STRAIGHT!

						newDirection = oldDirection;
					}

					if (newDirection == 1)
					{
						hillRangeX = hillRangeX - 1;
						hillRangeY = hillRangeY - 1;

						if (hillRangeX < 1)
						{
							hillRangeX = (mapSizeX);
						}
						if (hillRangeY < 1)
						{
							hillRangeY = (mapSizeY);
						}

						if (confineHills==1)
						{
							mountainTopX = hillRangeX;
							mountainTopY = hillRangeY;

							checkSeedLocation();

							if (goodSeedLocation==0)
							{
								asd = realHillLength;
//								constructorError.value += "\nKilled that hill range...";
							}
						}

						oldDirection = 1;
					}
					else if (newDirection == 2)
					{
						hillRangeX = hillRangeX;
						hillRangeY = hillRangeY - 1;

						if (hillRangeY < 1)
						{
							hillRangeY = (mapSizeY);
						}

						if (confineHills==1)
						{
							mountainTopX = hillRangeX;
							mountainTopY = hillRangeY;

							checkSeedLocation();

							if (goodSeedLocation==0)
							{
								asd = realHillLength;
							//	constructorError.value += "\nKilled that hill range...";
							}
						}

						oldDirection = 2;
					}
					else if (newDirection == 3)
					{
						hillRangeX = hillRangeX + 1;
						hillRangeY = hillRangeY - 1;

						if (hillRangeX > (mapSizeX))
						{
							hillRangeX = 1;
						}
						if (hillRangeY < 1)
						{
							hillRangeY = (mapSizeY);
						}

						if (confineHills==1)
						{
							mountainTopX = hillRangeX;
							mountainTopY = hillRangeY;

							checkSeedLocation();

							if (goodSeedLocation==0)
							{
								asd = realHillLength;
							//	constructorError.value += "\nKilled that hill range...";
							}
						}

						oldDirection = 3;
					}
					else if (newDirection == 4)
					{
						hillRangeX = hillRangeX - 1;
						hillRangeY = hillRangeY;

						if (hillRangeX < 1)
						{
							hillRangeX = (mapSizeX);
						}

						if (confineHills==1)
						{
							mountainTopX = hillRangeX;
							mountainTopY = hillRangeY;

							checkSeedLocation();

							if (goodSeedLocation==0)
							{
								asd = realHillLength;
							//	constructorError.value += "\nKilled that hill range...";
							}
						}

						oldDirection = 4;
					}
					else if (newDirection == 5)
					{
						hillRangeX = hillRangeX + 1;
						hillRangeY = hillRangeY;

						if (hillRangeX > (mapSizeX))
						{
							hillRangeX = 1;
						}

						if (confineHills==1)
						{
							mountainTopX = hillRangeX;
							mountainTopY = hillRangeY;

							checkSeedLocation();

							if (goodSeedLocation==0)
							{
								asd = realHillLength;
							//	constructorError.value += "\nKilled that hill range...";
							}
						}

						oldDirection = 5;
					}
					else if (newDirection == 6)
					{
						hillRangeX = hillRangeX - 1;
						hillRangeY = hillRangeY + 1;

						if (hillRangeX < 1)
						{
							hillRangeX = (mapSizeX);
						}
						if (hillRangeY > (mapSizeY))
						{
							hillRangeY = 1;
						}

						if (confineHills==1)
						{
							mountainTopX = hillRangeX;
							mountainTopY = hillRangeY;

							checkSeedLocation();

							if (goodSeedLocation==0)
							{
								asd = realHillLength;
							//	constructorError.value += "\nKilled that hill range...";
							}
						}

						oldDirection = 6;
					}
					else if (newDirection == 7)
					{
						hillRangeX = hillRangeX;
						hillRangeY = hillRangeY + 1;

						if (hillRangeY > (mapSizeY))
						{
							hillRangeY = 1;
						}

						if (confineHills==1)
						{
							mountainTopX = hillRangeX;
							mountainTopY = hillRangeY;

							checkSeedLocation();

							if (goodSeedLocation==0)
							{
								asd = realHillLength;
							//	constructorError.value += "\nKilled that hill range...";
							}
						}

						oldDirection = 7;
					}
					else if (newDirection == 8)
					{
						hillRangeX = hillRangeX + 1;
						hillRangeY = hillRangeY + 1;

						if (hillRangeX > (mapSizeX))
						{
							hillRangeX = 1;
						}
						if (hillRangeY > (mapSizeY))
						{
							hillRangeY = 1;
						}

						if (confineHills==1)
						{
							mountainTopX = hillRangeX;
							mountainTopY = hillRangeY;

							checkSeedLocation();

							if (goodSeedLocation==0)
							{
								asd = realHillLength;
							//	constructorError.value += "\nKilled that hill range...";
							}
						}

						oldDirection = 8;
					}

					if (goodSeedLocation==1)
					{
						if (mapArrayWorld[hillRangeX][hillRangeY] > 0 && mapArrayWorld[hillRangeX][hillRangeY] < z)
						{
						//	constructorError.value += "\nNOPE! Was going to "+hillRangeX+","+hillRangeY+", value is "+mapArrayWorld[hillRangeX][hillRangeY]+", but KILLED hill.";
						//	constructorError.value += "\nGoing to "+hillRangeX+","+hillRangeY+", value is "+mapArrayWorld[hillRangeX][hillRangeY];
							asd = realHillLength;
						}
						plotHilltop();
					}

//					mapArrayWorld[hillRangeX][hillRangeY] = z;
//					mapArrayWorld[hillRangeX+1][hillRangeY] = z;
//					mapArrayWorld[hillRangeX][hillRangeY+1] = z;
//					mapArrayWorld[hillRangeX+1][hillRangeY+1] = z;
				}
			}
		}
	}
}

function plotHilltop()
{
	if (maxHillGirth==1)
	{
		mapArrayWorld[(hillRangeX)][(hillRangeY)] = z;
	}
	else if (maxHillGirth==2)
	{
		for (y=0;y<=1;y++)
		{
			yb=y;
			for (x=0;x<=1;x++)
			{
				xb=x;
				if (((hillRangeX-0)+(x-0)) > mapSizeX)
				{
					xb=(1-(mapSizeX-0));
				}

				if (((hillRangeY-0)+(y-0)) > mapSizeY)
				{
					yb=(1-(mapSizeY-0));
				}

				mapArrayWorld[((hillRangeX-0)+(xb-0))][((hillRangeY-0)+(yb-0))] = z;
			//	b.value = b.value + "\nhill z: "+z
			}
		}
	}
	else
	{
		halfHillSize = Math.round(maxHillGirth * 0.5);
	//		document.myform.fieldError.value = document.myform.fieldError.value + "\nhalfMtnSize: "+halfMtnSize;
	//		document.myform.fieldError.scrollTop = document.myform.fieldError.scrollHeight;

		quarterHillSize = Math.round(maxHillGirth * 0.25);
		threeQuarterHillSize = quarterHillSize * 3;

		randomNumber = Math.floor(Math.random()*threeQuarterHillSize)+1;
	//		document.myform.fieldError.value = document.myform.fieldError.value + "\nrandomNumber: "+randomNumber;
	//		document.myform.fieldError.scrollTop = document.myform.fieldError.scrollHeight;

		maxHillGirthSpecific = maxHillGirth - randomNumber;
	//		document.myform.fieldError.value = document.myform.fieldError.value + "\nmtnSizeSpecific: "+mtnSizeSpecific;
	//		document.myform.fieldError.scrollTop = document.myform.fieldError.scrollHeight;

		hillRadius = Math.round(maxHillGirthSpecific / 2);
	//		document.myform.fieldError.value = document.myform.fieldError.value + "\nmtnRadius: "+mtnRadius;
	//		document.myform.fieldError.scrollTop = document.myform.fieldError.scrollHeight;

		negativeHillRadius = hillRadius - (hillRadius * 2);
	//		document.myform.fieldError.value = document.myform.fieldError.value + "\nnegativeMtnRadius: "+negativeMtnRadius;
	//		document.myform.fieldError.scrollTop = document.myform.fieldError.scrollHeight;

		if (hillRadius < 1)				{hillRadius = 1;}
		if (negativeHillRadius > (-1))	{negativeHillRadius = (-1);}

		for (q=negativeHillRadius;q<=hillRadius;q++)
		{
			for (p=negativeHillRadius;p<=hillRadius;p++)
			{
				if ((Math.abs((p * p)+(q * q))) <= ((hillRadius) * (hillRadius)))
				{
	//				checkAndAdjustMountainTopValues();

					if (((hillRangeX-0) + (p-0)) < 1)
	//				if (((hillRangeX-0) + (p-0)) <= 0)
					{
						hillRangeXb = ((hillRangeX-0) + (mapSizeX-0));
	//					document.myform.fieldError.value = document.myform.fieldError.value + "\nHIT DAT - mTopX:" + hillRangeX + " / p:"+p;
					}
					else if (((hillRangeX-0) + (p-0)) > mapSizeX)
					{
						hillRangeXb = (((hillRangeX-0)) - (mapSizeX-0));
					}
					else
					{
						hillRangeXb = hillRangeX;
					}

					if (((hillRangeY-0) + (q-0)) < 1)
					{
						hillRangeYb = ((hillRangeY-0) + (mapSizeY-0));
					}
					else if (((hillRangeY-0) + (q-0)) > mapSizeY)
					{
						hillRangeYb = (((hillRangeY-0)) - (mapSizeY-0));
					}
					else
					{
						hillRangeYb = hillRangeY;
					}

	//				document.myform.fieldError.value = document.myform.fieldError.value + "\nPLOT: " + ((hillRangeXb-0)+(p-0)) + "," + ((hillRangeYb-0)+(q-0));
	//				try
	//				{
						mapArrayWorld[((hillRangeXb-0)+(p-0))][((hillRangeYb-0)+(q-0))] = z;
					//	b.value = b.value + "\nz: "+z
	//					constructorError.value += "\nPlotted hill top at: "+((hillRangeXb-0)+(p-0))+","+((hillRangeYb-0)+(q-0));
	//				}
	//				catch(err)
	//				{
	//					document.myform.fieldError.value = document.myform.fieldError.value + "\nERROR - mTopX:"+hillRangeX+" / mTopXb:"+hillRangeXb+" / p:"+p+" / "+(hillRangeX + p);
	//				}
				}
			}
		}
	//		document.myform.fieldError.value = document.myform.fieldError.value + "\nPLOT MOUNTAIN! ("+hillRangeX+","+hillRangeY+")";
	//		document.myform.fieldError.scrollTop = document.myform.fieldError.scrollHeight;
	}
}

function growALevel()
{
	squareCount = 0;

/*
	if (secondLevelGrown==0)
	{
		z = 2;

		secondLevelGrown = 1;
	}
*/

	if (z==2)
	{
		ngr = (-3);
		pgr = 3;
	}

	negativeGrowthRadius = Math.round(ngr);
	positiveGrowthRadius = Math.round(pgr);

	worldNotFull = 1;

	if (z > 3)
	{
//		constructorError.value = constructorError.value + '\nSeeding hill ranges... worldNotFull='+worldNotFull;
		seedHillRanges();
	}

	getTime();

	levelFull = 1;

	//	STEPPING THROUGH... ONE TILE AT A TIME...

	/*
		Traverse through world array.
		If a tile is oblivion, then the world isn't full.
		If it finds a tile what is not oblivion, examine the 8 surrounding tiles for oblivion.
			If one of the 8 tiles is oblivion, then make land.
			If none of the 8 tiles is oblivion, then do nothing.
	*/

	foundOblivion = 0;

//	constructorError.value = constructorError.value + "\nAdding array value of (z): "+z;

	for (y=1;y<=mapSizeY;y++)
	{
		for (x=1;x<=mapSizeX;x++)
		{

			//	IF THERES NOTHING THERE... THEN THE WORLD IS FULL.

			if (mapArrayWorld[x][y] == 0)
			{
				foundOblivion = 1;
			}

			//	IF THE TILE ABOVE IS THE LEVEL ABOVE >>> AND ON THE EDGE OF OBLIVION <<< ... DO STUFF.

			if (mapArrayWorld[x][y] > 0 && mapArrayWorld[x][y] < z)
			{
				edgeOfOblivion = 0;

				for (eoy = (-1); eoy <= 1; eoy++)
				{
					eoyy = eoy;
					if (y+eoyy < 1 || y+eoyy > mapSizeY)
					{
						eoyy = 0;
					}
					for (eox = (-1); eox <= 1; eox++)
					{
						eoxx = eox;
						if (x+eoxx < 1 || x+eoxx > mapSizeX)
						{
							eoxx = 0;
						}

						if (mapArrayWorld[(x+eoxx)][(y+eoyy)] == 0)
						{
							edgeOfOblivion = 1;
						}
					}
				}

				if (edgeOfOblivion == 1)
				{
					randomNumber=Math.floor(Math.random()*100)+1;

					//	BUT ONLY 3% OF THE TIME.

					if (randomNumber <= landUniformity)
					{
						for (d = negativeGrowthRadius; d <= positiveGrowthRadius; d++)
						{
							for (c = negativeGrowthRadius; c <= positiveGrowthRadius; c++)
							{
								if ((Math.abs((d * d)+(c * c))) <= (positiveGrowthRadius * positiveGrowthRadius))
								{
									if (((x-0) + (c-0)) < 1)
									{
										Xb = ((x-0) + (mapSizeX-0));
									}
									else if (((x-0) + (c-0)) > (mapSizeX-0))
									{
										Xb = ((x-0) - (mapSizeX-0));
									}
									else
									{
										Xb = x;
									}
									if (((y-0) + (d-0)) < 1)
									{
										Yb = ((y-0) + (mapSizeY-0));
									}
									else if (((y-0) + (d-0)) > (mapSizeY-0))
									{
										Yb = ((y-0) - (mapSizeY-0));
									}
									else
									{
										Yb = y;
									}

									if (mapArrayWorld[Xb+c][Yb+d]==0)
									{
										mapArrayWorld[Xb+c][Yb+d] = z;
										squareCount = squareCount + 1;
									}
								}
							}
						}
					}
				}
			}
		}
	}
	if (foundOblivion == 0)
	{
		worldNotFull = 0;
	}
	foundOblivion = 1;

	adjustGrowthRadius();
	z = z + 1;

	if (worldNotFull==1)
	{
		doGrowWorld = 1;
	}
	else
	{
		doCopyWorldArray = 1;
		constructorError.value = constructorError.value + '\nCopying world array from growALevel();';
		//	doLoadDisplayArray = 1;
	}
}

function adjustGrowthRadius()
{
//	ngr = ngr * 1.14;
//	pgr = pgr * 1.14;

	ngr = ngr * (landSlope / 100);
	pgr = pgr * (landSlope / 100);

	negativeGrowthRadius = Math.round(ngr);
	positiveGrowthRadius = Math.round(pgr);

	ngr = ngr * 100;
	pgr = pgr * 100;

	ngrb = Math.round(ngr);
	pgrb = Math.round(pgr);

	ngr = ngrb / 100;
	pgr = pgrb / 100;
}

function getTime()
{
	var time = new Date();
	var hours = time.getHours();
	var minutes = time.getMinutes();
	var seconds = time.getSeconds();
	hoursQ = hours;
	minutesQ = minutes;
	secondsQ = seconds;

	if (hours > 12)
	{
		hours = hours - 12;
	}
	if (minutes < 10)
	{
		minutes = "0" + minutes;
	}
	if (seconds < 10)
	{
		seconds = "0" + seconds;
	}
	timeText = hours + ":" + minutes + ":" + seconds;
}

function closeAllDivs()
{
//	document.getElementById("divSplash").style.display="none";
	document.getElementById("divConstructor").style.display="none";
//	document.getElementById("divConstructorStage2").style.display="none";
//	document.getElementById("divAbout").style.display="none";
//	document.getElementById("divInstructions").style.display="none";
	document.getElementById("divBuilder").style.display="none";
//	document.getElementById("divClimateBuilder").style.display="none";
//	document.getElementById("divZoomEdit").style.display="none";
//	document.getElementById("divLoad").style.display="none";
//	document.getElementById("divWorldMap").style.display="none";
//	document.getElementById("divCompressedText").style.display="none";
//	document.getElementById("divDisplayText").style.display="none";
}

function initWorldArray()
{
//	constructorError.value = constructorError.value + "\nmapSizeX: "+mapSizeX+", mapSizeY: "+mapSizeY;
	if (loadingMap==0)
	{
		for (x=1;x<=mapSizeX;x++)
		{
			mapArrayWorld[x] = new Array(mapSizeY);
			mapArrayDev[x] = new Array(mapSizeY);
		}
		for (x=1;x<=mapSizeX;x++)
		{
			for (y=1;y<=mapSizeY;y++)
			{
				mapArrayWorld[x][y] = 0;
				mapArrayDev[x][y] = 0;
				if (x==100 && y==100)
				{
			//		constructorError.value = constructorError.value + "\nGot to 100 x 100.";
				}
				if (x==mapSizeX && y==mapSizeY)
				{
					doInitWorldArray = 3;
			//		constructorError.value = constructorError.value + "\nGot to mapSizeX x mapSizeY.";
			//		constructorError.value = constructorError.value + "\nValue of mapArrayWorld[mapSizeX][mapSizeY] is: "+mapArrayWorld[mapSizeX][mapSizeY];
				}
			}
		}
	}
}

function initDisplayArray()
{
	if (loadingMap==0)
	{
		for (x=1;x<=1000;x++)
		{
			mapArrayDisplay[x] = new Array(1000);
		}
		for (x=1;x<=1000;x++)
		{
			for (y=1;y<=1000;y++)
			{
				mapArrayDisplay[x][y] = 0;

				if (x==1000 && y==1000)
				{
					doInitDisplayArray = 2;
				}
			}
		}
	}
}

function checkForContinentSelection()
{
	continentsAreSelected = 0;

	for (y=1;y<=100;y++)
	{
		for (x=1;x<=100;x++)
		{
			if (boxAddressArray[x][y]=="land")
			{
				continentsAreSelected = 1;
		//		constructorError.value = constructorError.value + "\nFound land.";
			}
			if (y==100 && x==100)
			{
				doCheckForContinentSelection = 3;
			}
		}
	}
}

function seedMountainRanges()
{
	z = 1;
	for (r=1;r<=numMtnRanges;r++)
//	for (r=1;r<=1;r++)
	{
		halfRangeLength = Math.round(((maxMtnLength / 100) * mapSizeX) / 2);
		quarterRangeLength = Math.round(((maxMtnLength / 100) * mapSizeX) / 4);
		threeQuarterRangeLength = quarterRangeLength * 3;
		rangeLength = Math.round(Math.floor(Math.random() * halfRangeLength + 1) + halfRangeLength);

//		constructorError.value += "\nrangeLength will be " + rangeLength;

		// LOCATE MOUNTAIN RANGE SPAWN POINT

		rangeSpawnPointOkay = 0;

		while (rangeSpawnPointOkay == 0)
		{
			mountainTopX = Math.floor((Math.random()*mapSizeX)+1);
			mountainTopY = Math.floor((Math.random()*mapSizeY)+1);

			checkSeedLocation();

			if (goodSeedLocation==1)
			{
//				constructorError.value += "\n" + mountainTopX + "," + mountainTopY + ": GOOD seed location: "+boxAddressArray[designatedBoxX][designatedBoxY];
				plotMountain();
				rangeSpawnPointOkay = 1;
			}
			else
			{
//				constructorError.value += "\n" + mountainTopX + "," + mountainTopY + ": BAD seed location: "+boxAddressArray[designatedBoxX][designatedBoxY];
			}
		}

		goodSeedLocation = 0;

		// SET MOUNTAIN RANGE DIRECTION

		// PICK TWO RANDOM COORDINATES

		randomNumberA = Math.floor((Math.random()*500)+1);
		randomNumberB = Math.floor((Math.random()*500)+1);

		coordinateX = randomNumberA - 250;
		coordinateY = randomNumberB - 250;

		// left:	=50-X
		// right:	=50+X
		// up:		=50+Y
		// down:	=50-Y

		rangeLeftPct = (250 - coordinateX);
		rangeRightPct = (250 + coordinateX);
		rangeTopPct = (250 + coordinateY);
		rangeBottomPct = (250 - coordinateY);

//		rangeLeftPct = (250 - coordinateX) * 4;
//		rangeRightPct = (250 + coordinateX) * 4;
//		rangeTopPct = (250 + coordinateY) * 4;
//		rangeBottomPct = (250 - coordinateY) * 4;

		rangeTotalPct = (rangeTopPct + rangeBottomPct + rangeLeftPct + rangeRightPct);

		oldRangeDirection = "";

		for (rangeSteps=1;rangeSteps<=rangeLength;rangeSteps++)
		{
			directionApproved = 0;
			tries = 0;

			while (directionApproved==0 && tries <= 100)
			{
				goodSeedLocation = 0;

				//	STORE CURRENT MOUNTAINTOP X & Y COORDINATES

					tempMountainTopX = mountainTopX;
					tempMountainTopY = mountainTopY;

				//	USING MULTIPLIED PERCENTS, ROLL FOR DIRECTION

//				constructorError.value += "Roll";

				rangeTopRoll = Math.floor(Math.random()*(rangeTopPct))+1;
				rangeBottomRoll = Math.floor(Math.random()*(rangeBottomPct))+1;
				rangeLeftRoll = Math.floor(Math.random()*(rangeLeftPct))+1;
				rangeRightRoll = Math.floor(Math.random()*(rangeRightPct))+1;

				//	DETERMINE DIRECTION BASED ON HIGH ROLL

				if (rangeTopRoll > rangeBottomRoll &&
					rangeTopRoll > rangeLeftRoll &&
					rangeTopRoll > rangeRightRoll)
				{
					// CHECK UP

					mountainTopY = mountainTopY - 1;
					if (mountainTopY < 1)	{mountainTopY = mapSizeY;}
					checkSeedLocation();
					if (goodSeedLocation==1 && oldRangeDirection != "down")
					{
//						constructorError.value += "\n...old direction was "+oldRangeDirection+" ...going up.";
						oldRangeDirection = "up";
						plotMountain();
						directionApproved = 1;
					}
					else
					{
						mountainTopX = tempMountainTopX;
						mountainTopY = tempMountainTopY;
//						constructorError.value += "\nBAD DIRECTION!";
					}
				}
				else if (rangeBottomRoll > rangeLeftRoll &&
						 rangeBottomRoll > rangeRightRoll)
				{
					// CHECK DOWN

					mountainTopY = mountainTopY + 1;
					if (mountainTopY > mapSizeY)	{mountainTopY = 1;}
					checkSeedLocation();
					if (goodSeedLocation==1 && oldRangeDirection != "up")
					{
//						constructorError.value += "\n...old direction was "+oldRangeDirection+" ...going down.";
						oldRangeDirection = "down";
						plotMountain();
						directionApproved = 1;
					}
					else
					{
						mountainTopX = tempMountainTopX;
						mountainTopY = tempMountainTopY;
//						constructorError.value += "\nBAD DIRECTION!";
					}
				}
				else if (rangeLeftRoll > rangeRightRoll)
				{
					// CHECK LEFT

					mountainTopX = mountainTopX - 1;
					if (mountainTopX < 1)	{mountainTopX = mapSizeX;}
					checkSeedLocation();
					if (goodSeedLocation==1 && oldRangeDirection != "right")
					{
//						constructorError.value += "\n...old direction was "+oldRangeDirection+" ...going left.";
						oldRangeDirection = "left";
						plotMountain();
						directionApproved = 1;
					}
					else
					{
						mountainTopX = tempMountainTopX;
						mountainTopY = tempMountainTopY;
//						constructorError.value += "\nBAD DIRECTION!";
					}
				}
				else
				{
					// CHECK RIGHT

					mountainTopX = (mountainTopX-0) + 1;
					if (mountainTopX > mapSizeX)	{mountainTopX = 1;}
					checkSeedLocation();
					if (goodSeedLocation==1 && oldRangeDirection != "left")
					{
//						constructorError.value += "\n...old direction was "+oldRangeDirection+" ...going right.";
						oldRangeDirection = "right";
						plotMountain();
						directionApproved = 1;
					}
					else
					{
						mountainTopX = tempMountainTopX;
						mountainTopY = tempMountainTopY;
//						constructorError.value += "\nBAD DIRECTION!";
					}
				}

				tries = 100;
				tries += 1;
			}
		}
		if (r==numMtnRanges)
		{
			doSeedMountainRanges = 3;
		}
	}
}

function plotMountain()
{
//	constructorError.value += "\nGot to plotMountain()."
	var mountainTopXb=0;
	var mountainTopYb=0;
	var r=0;
	var s=0;

	if (mountainTopX==0)
	{
		constructorError.value += "\n### ERROR ### - plotMountain()";
	}

	try
	{
		if (maxMtnGirth==1)
		{
//			constructorError.value += "...Trying to plot...";
			mapArrayWorld[(mountainTopX)][(mountainTopY)] = 1;
//			constructorError.value += "\nPlotted: "+(mountainTopX)+","+(mountainTopY);
		}

		else if (maxMtnGirth==2)
		{
			for (y=0;y<=1;y++)
			{
				yb=y;
				for (x=0;x<=1;x++)
				{
					xb=x;
					if (((mountainTopX-0)+(x-0)) > mapSizeX)
					{
						xb=(1-(mapSizeX-0));
					}

					if (((mountainTopY-0)+(y-0)) > mapSizeY)
					{
						yb=(1-(mapSizeY-0));
					}

					mapArrayWorld[((mountainTopX-0)+(xb-0))][((mountainTopY-0)+(yb-0))] = 1;
				}
			}
		}

		else
		{
			halfMtnSize = Math.floor(maxMtnGirth * 0.5);
		//	document.myform.fieldError.value = document.myform.fieldError.value + "\nhalfMtnSize: "+halfMtnSize;
		//	document.myform.fieldError.scrollTop = document.myform.fieldError.scrollHeight;

			randomNumber = Math.floor(Math.random()*halfMtnSize)+1;
		//	document.myform.fieldError.value = document.myform.fieldError.value + "\nrandomNumber: "+randomNumber;
		//	document.myform.fieldError.scrollTop = document.myform.fieldError.scrollHeight;

			maxMtnGirthSpecific = maxMtnGirth - randomNumber;
		//	document.myform.fieldError.value = document.myform.fieldError.value + "\nmaxMtnGirthSpecific: "+maxMtnGirthSpecific;
		//	document.myform.fieldError.scrollTop = document.myform.fieldError.scrollHeight;

		//	mtnRadius = halfMtnSize;
			mtnRadius = Math.round(maxMtnGirthSpecific / 2);
		//	document.myform.fieldError.value = document.myform.fieldError.value + "\nmtnRadius: "+mtnRadius;
		//	document.myform.fieldError.scrollTop = document.myform.fieldError.scrollHeight;

			negativeMtnRadius = mtnRadius - (mtnRadius * 2);
		//	document.myform.fieldError.value = document.myform.fieldError.value + "\nnegativeMtnRadius: "+negativeMtnRadius;
		//	document.myform.fieldError.scrollTop = document.myform.fieldError.scrollHeight;

			if (mtnRadius < 1)				{mtnRadius = 1;}
			if (negativeMtnRadius > (-1))	{negativeMtnRadius = (-1);}

			for (q=negativeMtnRadius;q<=mtnRadius;q++)
			{
				s=q;
				for (p=negativeMtnRadius;p<=mtnRadius;p++)
				{
					r=p;

//					document.myform.fieldError.value = document.myform.fieldError.value + "\nr: "+r+"s: "+s;

					if ((Math.abs((r * r)+(s * s))) <= ((mtnRadius) * (mtnRadius)))
					{
						if (((mountainTopX-0) + r) < 1)
						{
							mountainTopXb = (((mountainTopX-0)) + (mapSizeX-0));
						}
						else if (((mountainTopX-0) + r) > mapSizeX)
						{
							mountainTopXb = (((mountainTopX-0)) - (mapSizeX-0));
						}
						else
						{
							mountainTopXb = mountainTopX;
						}

						if (((mountainTopY-0) + s) < 1)
						{
							mountainTopYb = (((mountainTopY-0)) + (mapSizeY-0));
						}
						else if (((mountainTopY-0) + s) > mapSizeY)
						{
							mountainTopYb = (((mountainTopY-0)) - (mapSizeY-0));
						}
						else
						{
							mountainTopYb = mountainTopY;
						}

//						checkAndAdjustMountainTopValues();
						mapArrayWorld[(mountainTopXb+r)][(mountainTopYb+s)] = 1;
//						constructorError.value += "\nPlotted: "+(mountainTopXb+r)+","+(mountainTopYb+s);
//						document.myform.fieldError.value = document.myform.fieldError.value + "\nPLOT MOUNTAIN! ("+(mountainTopX)+","+(mountainTopY)+"), r:"+r+", s:"+s;
//						document.myform.fieldError.scrollTop = document.myform.fieldError.scrollHeight;
					}
				}
			}
		}
	}
	catch(err)
	{
//		errorCount += 1;
		constructorError.value += "\n### ERROR (Caught) ### - plotMountain()";
//		getTime();
//		constructorError.value += "\n" + timeText + " - Minor issue in plotting... [Corrected]";
//		constructorError.value += "\nCATCH "+errorCount+" (plotMountain) - p:"+p+", q:"+q+", r:"+r+", s:"+s+", mTopX: " + ((mountainTopXb-0)) + ", mTopY: " + ((mountainTopYb-0));
//		document.myform.fieldError.value = document.myform.fieldError.value + "\nr: " + r;
//		document.myform.fieldError.value = document.myform.fieldError.value + "\nmountainTopY: " + (mountainTopY+s);
//		document.myform.fieldError.value = document.myform.fieldError.value + "\ns: " + s;
//		constructorError.scrollTop = constructorError.scrollHeight;
	}
}

function checkSeedLocation()
{
	if (checkingHillLocation==2)
	{
		goodSeedLocation = 0;
		if (mapArrayWorld[mountainTopX][mountainTopY]==0 || mapArrayWorld[mountainTopX][mountainTopY]==z)
		{
//			constructorError.value += "\ncheckingHillLocation = 2, mapArrayWorld["+mountainTopX+"]["+mountainTopY+"] = "+mapArrayWorld[mountainTopX][mountainTopY]+", z = "+z;
			tilesPerBoxX = Math.round(mapSizeX / 100);
			tilesPerBoxY = Math.round(mapSizeY / 100);

			mountainTopXc = mountainTopX - 1;
			mountainTopYc = mountainTopY - 1;

			designatedBoxX = Math.floor((mountainTopXc / tilesPerBoxX)+1);
			designatedBoxY = Math.floor((mountainTopYc / tilesPerBoxY)+1);

		//	constructorError.value += "\ntilesPerBoxX: "+tilesPerBoxX;
		//	constructorError.value += "\ntilesPerBoxY: "+tilesPerBoxY;

		//	constructorError.value += "\nChecking location...";
		//	constructorError.value += "\nPoint ("+mountainTopX+","+mountainTopY+") is in box ("+designatedBoxX+","+designatedBoxY+").";
		//	constructorError.value += "\nBox ("+designatedBoxX+","+designatedBoxY+") is "+boxAddressArray[designatedBoxX][designatedBoxY]+".";
		//	constructorError.scrollTop = constructorError.scrollHeight;

			if (boxAddressArray[designatedBoxX][designatedBoxY] == "land")
			{
				goodSeedLocation = 1;
		//		constructorError.value += "...GOOD seed location.";
		//		b.value = b.value + "\nSeed location: " + mountainTopXc + ", " + mountainTopYc;

			}
			else if (boxAddressArray[designatedBoxX][designatedBoxY] == "ocean")
			{
				goodSeedLocation = 0;
		//		constructorError.value += "...BAD seed location.";
			}
		}
		else
		{
//			constructorError.value += "\ncheckingHillLocation = 2, mapArrayWorld["+mountainTopX+"]["+mountainTopY+"] = "+mapArrayWorld[mountainTopX][mountainTopY]+", z = "+z;
		}
	}
	else if (checkingHillLocation==1)
	{
		goodSeedLocation = 0;
		if (mapArrayWorld[mountainTopX][mountainTopY]==0 || mapArrayWorld[mountainTopX][mountainTopY]==z)
		{
			tilesPerBoxX = Math.round(mapSizeX / 100);
			tilesPerBoxY = Math.round(mapSizeY / 100);

			mountainTopXc = mountainTopX - 1;
			mountainTopYc = mountainTopY - 1;

			designatedBoxX = Math.floor((mountainTopXc / tilesPerBoxX)+1);
			designatedBoxY = Math.floor((mountainTopYc / tilesPerBoxY)+1);

		//	constructorError.value += "\ntilesPerBoxX: "+tilesPerBoxX;
		//	constructorError.value += "\ntilesPerBoxY: "+tilesPerBoxY;

		//	constructorError.value += "\nChecking location...";
		//	constructorError.value += "\nPoint ("+mountainTopX+","+mountainTopY+") is in box ("+designatedBoxX+","+designatedBoxY+").";
		//	constructorError.value += "\nBox ("+designatedBoxX+","+designatedBoxY+") is "+boxAddressArray[designatedBoxX][designatedBoxY]+".";
		//	constructorError.scrollTop = constructorError.scrollHeight;

			if (boxAddressArray[designatedBoxX][designatedBoxY] == "land")
			{
				goodSeedLocation = 1;
		//		constructorError.value += "\nGood seed location.";
		//		b.value = b.value + "\nSeed location: " + mountainTopXc + ", " + mountainTopYc;

			}
			else if (boxAddressArray[designatedBoxX][designatedBoxY] == "ocean")
			{
				goodSeedLocation = 0;
			}
		}
//		else
//		{
//			constructorError.value += "\ncheckingHillLocation = 1, mapArrayWorld["+mountainTopX+"]["+mountainTopY+"] = "+mapArrayWorld[mountainTopX][mountainTopY]+", z = "+z;
//		}
	}
	else
//	try
	{
		goodSeedLocation = 0;
//		if (mapArrayWorld[mountainTopX][mountainTopY]==0)
//		{
			tilesPerBoxX = Math.round(mapSizeX / 100);
			tilesPerBoxY = Math.round(mapSizeY / 100);

			mountainTopXc = mountainTopX - 1;
			mountainTopYc = mountainTopY - 1;

			designatedBoxX = Math.floor((mountainTopXc / tilesPerBoxX)+1);
			designatedBoxY = Math.floor((mountainTopYc / tilesPerBoxY)+1);

		//	constructorError.value += "\ntilesPerBoxX: "+tilesPerBoxX;
		//	constructorError.value += "\ntilesPerBoxY: "+tilesPerBoxY;

		//	constructorError.value += "\nChecking location...";
		//	constructorError.value += "\nPoint ("+mountainTopX+","+mountainTopY+") is in box ("+designatedBoxX+","+designatedBoxY+").";
		//	constructorError.value += "\nBox ("+designatedBoxX+","+designatedBoxY+") is "+boxAddressArray[designatedBoxX][designatedBoxY]+".";
		//	constructorError.scrollTop = constructorError.scrollHeight;

			if (boxAddressArray[designatedBoxX][designatedBoxY] == "land")
			{
				goodSeedLocation = 1;
		//		constructorError.value += "\nGood seed location.";
		//		b.value = b.value + "\nSeed location: " + mountainTopXc + ", " + mountainTopYc;

			}
			else if (boxAddressArray[designatedBoxX][designatedBoxY] == "ocean")
			{
				goodSeedLocation = 0;
			}
//		}
	}
//	catch(err)
//	{
//		b.value += "\nERROR! (checkSeedLocation) - MX,MY: "+mountainTopX+","+mountainTopY+" - Designated box: "+designatedBoxX+","+designatedBoxY;
//	}
	checkingHillLocation = 0;
}

function seedVolcano()
{
	var halfVolcanoSize = Math.round(maxVolcanoSize * 0.5);
		randomNumber=Math.floor(Math.random()*halfVolcanoSize)+1;
	var maxVolcanoSizeSpecific = maxVolcanoSize - randomNumber;
	var volcanoRadius = Math.round(maxVolcanoSizeSpecific / 2);
	if (volcanoRadius < 3)
	{
		volcanoRadius = 3;
	}
	var negativeVolcanoRadius = volcanoRadius - (volcanoRadius * 2);

	var volcanoSeedTries = 0;
	var goodVolcanoSeedPoint = 0;

	while (goodVolcanoSeedPoint==0 && volcanoSeedTries <= 500000)
	{
		volcanoSeedTries = volcanoSeedTries + 1;

		volcanoX = randomNumber=Math.floor(Math.random()*mapSizeX)+1;
		volcanoY = randomNumber=Math.floor(Math.random()*mapSizeY)+1;

		if (mapArrayWorld[volcanoX][volcanoY] == 1)
		{
			volcanoSeedPointTooClose = 0;
			for (q=(negativeVolcanoRadius * 2);q<=(volcanoRadius * 2);q++)
			{
				s=q;
				for (p=(negativeVolcanoRadius * 2);p<=(volcanoRadius * 2);p++)
				{
					r=p;

					if (((volcanoX-0) + r) < 1)
					{
						volcanoXb = (((volcanoX-0)) + (mapSizeX-0));
					}
					else if (((volcanoX-0) + r) > mapSizeX)
					{
						volcanoXb = (((volcanoX-0)) - (mapSizeX-0));
					}
					else
					{
						volcanoXb = volcanoX;
					}

					if (((volcanoY-0) + s) < 1)
					{
						volcanoYb = (((volcanoY-0)) + (mapSizeY-0));
					}
					else if (((volcanoY-0) + s) > mapSizeY)
					{
						volcanoYb = (((volcanoY-0)) - (mapSizeY-0));
					}
					else
					{
						volcanoYb = volcanoY;
					}

					if (mapArrayWorld[volcanoXb+r][volcanoYb+s] == 0.5)
					{
						volcanoSeedPointTooClose = 1;
						builderError.value = builderError.value + "\nVolcano seed point too close!";
					}
				}
			}
			if (volcanoSeedPointTooClose==0)
			{
				goodVolcanoSeedPoint = 1;
				builderError.value = builderError.value + "\nGot a good volcano seed point.";
			}
		}
	}

	if (goodVolcanoSeedPoint==1)
	{
		volcanoCount = volcanoCount + 1;
		volcanoXArray[volcanoCount] = volcanoX;
		volcanoYArray[volcanoCount] = volcanoY;

		builderError.value = builderError.value + "\nVolcano seed point found: "+volcanoX+","+volcanoY;
		builderError.value = builderError.value + "\nVolcano seed tries: "+volcanoSeedTries;
		builderError.scrollTop = builderError.scrollHeight;

		for (q=negativeVolcanoRadius;q<=volcanoRadius;q++)
		{
			s=q;
			for (p=negativeVolcanoRadius;p<=volcanoRadius;p++)
			{
				r=p;
				if ((Math.abs((r * r)+(s * s))) <= ((volcanoRadius) * (volcanoRadius)))
				{
					if (((volcanoX-0) + r) < 1)
					{
						volcanoXb = (((volcanoX-0)) + (mapSizeX-0));
					}
					else if (((volcanoX-0) + r) > mapSizeX)
					{
						volcanoXb = (((volcanoX-0)) - (mapSizeX-0));
					}
					else
					{
						volcanoXb = volcanoX;
					}

					if (((volcanoY-0) + s) < 1)
					{
						volcanoYb = (((volcanoY-0)) + (mapSizeY-0));
					}
					else if (((volcanoY-0) + s) > mapSizeY)
					{
						volcanoYb = (((volcanoY-0)) - (mapSizeY-0));
					}
					else
					{
						volcanoYb = volcanoY;
					}

					mapArrayWorld[volcanoXb+r][volcanoYb+s] = 0.5;
				}
			}
		}

		for (y=1;y<=mapSizeY;y++)
		{
			for (x=1;x<=mapSizeX;x++)
			{
				if (mapArrayWorld[x][y] == 0.5)
				{
					for (q=(-1);q<=1;q++)
					{
						s=q;
						for (p=(-1);p<=1;p++)
						{
							r=p;

							if ((x+r) < 1)			{r=(mapSizeX-1);}
							if ((x+r) > mapSizeX)	{r=((mapSizeX*(-1))+1);}
							if ((y+s) < 1)			{s=(mapSizeY-1);}
							if ((y+s) > mapSizeY)	{s=((mapSizeY*(-1))+1);}

					//		if (mapArrayWorld[x+r][y+s] != 1 && mapArrayWorld[x+r][y+s] != 1.5 && mapArrayWorld[x+r][y+s] != 3)
							if (mapArrayWorld[x+r][y+s] != 1 && mapArrayWorld[x+r][y+s] != 0.5)
							{
								mapArrayWorld[x+r][y+s] = 1;
							}
						}
					}
				}
			}
		}
		if (volcanoCount==1)
		{
			getTime();
			constructorError.value += "\n[" + timeText + "] - 1 volcano created. ("+volcanoSeedTries+" seed points tried.)";
		//	firstHourQ = hours;
		//	firstMinuteQ = minutes;
		//	firstSecondQ = seconds;
		}
		else
		{
			getTime();
			constructorError.value += "\n[" + timeText + "] - " + volcanoCount + " volcanoes created. ("+volcanoSeedTries+" seed points tried.)";
		}
	}
	else
	{
		getTime();
		constructorError.value += "\n[" + timeText + "] - Volcano aborted! (500000 seed points tried.)";
		constructorError.scrollTop = constructorError.scrollHeight;
	}
//	constructorError.scrollTop = constructorError.scrollHeight;
	numVolcanoes = numVolcanoes - 1;
//	constructorError.value += "\nVolcanoes remaining to be seeded: "+numVolcanoes;
//	constructorError.scrollTop = constructorError.scrollHeight;
	doSeedVolcano = 2;
//	constructorError.value += "\nSet doSeedVolcano to 2.";
//	constructorError.scrollTop = constructorError.scrollHeight;
}

function selectAll()
{
	builderError.value += "\nSelect ALL land.";
	builderError.scrollTop = builderError.scrollHeight;
	for (y=1;y<=100;y++)
	{
		for (x=1;x<=100;x++)
		{
			document.getElementById("checkboxx"+(x)+"y"+(y)).style.background="url(boxgreen10.png) no-repeat";
			boxAddressArray[x][y] = "land";
		}
	}
	drawingLand=0;
//	buttonEraseLand.disabled=true;
//	buttonDrawLand.disabled=false;
}

function loadDisplayArray()
{
//	constructor2Error.value = constructor2Error.value + "\nGot to loadDisplayArray();";

	var divisor1 = mapSizeX / 1000;
	var divisor2 = mapSizeY / 1000;
	var divisor = 0;

	if (divisor1 >= divisor2)
	{
		divisor = divisor1;
	}
	else
	{
		divisor = divisor2;
	}

//	constructor2Error.value = constructor2Error.value + "\ndivisor = "+divisor;

	if (divisor==1)
	{
		for (y=1;y<=1000;y++)
		{
			for (x=1;x<=1000;x++)
			{
				mapArrayDisplay[x][y] = mapArrayDev[x][y];
				if (y==1000 && x==1000)
				{
					doLoadDisplayArray = 2;
				}
			}
		}
	}
	else
	{

		for (y=1;y<=1000;y++)
		{
			for (x=1;x<=1000;x++)
			{
				leastValue = 9999;
				for (b=((y*divisor)-(divisor-1));b<=(y*divisor);b++)
				{
					for (a=((x*divisor)-(divisor-1));a<=(x*divisor);a++)
					{
						newValue = mapArrayDev[a][b];
						if (newValue < leastValue)
						{
							leastValue = newValue;
						}
					}
				}
				mapArrayDisplay[x][y] = leastValue;
				if (y==1000 && x==1000)
				{
					doLoadDisplayArray = 2;
				}
			}
		}
	}
}

function drawTheWorld()
{
	if (drawingWater==0)
	{
		var canvasThing1 = document.getElementById("worldMapDisplay");
//		constructorError.value = constructorError.value + "\nDrawing to worldMapDisplay...";
	}
	else
	{
		var canvasThing1 = document.getElementById("waterMapDisplay");
//		constructor2Error.value = constructor2Error.value + "\nDrawing to waterMapDisplay...";
	}
	var ctx1 = canvasThing1.getContext('2d');

	canvasThing1.width=1000;
	canvasThing1.height=1000;
	worldMapDisplay.width=1000;
	worldMapDisplay.height=1000;

	//	FIRST QUADRANT	---------------------------------------------------------------------

	getTime();
	constructorError.value = constructorError.value + "\n["+timeText+"] - Starting draw 1...";
	for (y=1; y<=1000; y++)
	{
		for (x=1; x<=1000; x++)
		{

		//	xx = x/(mapSizeX/600);
		//	yy = y/(mapSizeY/600);

			xx = x;
			yy = y;

			if (mapArrayDisplay[x][y]==(-2)){ctx1.fillStyle="#182c65"; ctx1.fillRect(xx,yy,1,1);}		// dark blue
			else if (mapArrayDisplay[x][y]==(-1)){ctx1.fillStyle="#274382"; ctx1.fillRect(xx,yy,1,1);}	// medium blue
			else if (mapArrayDisplay[x][y]==0){ctx1.fillStyle="#4f69aa"; ctx1.fillRect(xx,yy,1,1);}		// light blue
			else if (mapArrayDisplay[x][y]==1){ctx1.fillStyle="#FFFFFF"; ctx1.fillRect(xx,yy,1,1);}		// white
			else if (mapArrayDisplay[x][y]==2){ctx1.fillStyle="#FAFAFA"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==3){ctx1.fillStyle="#F5F5F5"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==4){ctx1.fillStyle="#F0F0F0"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==5){ctx1.fillStyle="#EBEBEB"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==6){ctx1.fillStyle="#E6E6E6"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==7){ctx1.fillStyle="#E1E1E1"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==8){ctx1.fillStyle="#DCDCDC"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==9){ctx1.fillStyle="#D7D7D7"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==10){ctx1.fillStyle="#D2D2D2"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==11){ctx1.fillStyle="#CDCDCD"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==12){ctx1.fillStyle="#C8C8C8"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==13){ctx1.fillStyle="#C3C3C3"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==14){ctx1.fillStyle="#BEBEBE"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==15){ctx1.fillStyle="#B9B9B9"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==16){ctx1.fillStyle="#B4B4B4"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==17){ctx1.fillStyle="#AFAFAF"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==18){ctx1.fillStyle="#AAAAAA"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==19){ctx1.fillStyle="#A5A5A5"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==20){ctx1.fillStyle="#A0A0A0"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==21){ctx1.fillStyle="#9B9B9B"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==22){ctx1.fillStyle="#969696"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==23){ctx1.fillStyle="#919191"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==24){ctx1.fillStyle="#8C8C8C"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==25){ctx1.fillStyle="#878787"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==26){ctx1.fillStyle="#828282"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==27){ctx1.fillStyle="#7D7D7D"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==28){ctx1.fillStyle="#787878"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==29){ctx1.fillStyle="#737373"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==30){ctx1.fillStyle="#6E6E6E"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==31){ctx1.fillStyle="#696969"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==32){ctx1.fillStyle="#646464"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==33){ctx1.fillStyle="#5F5F5F"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==34){ctx1.fillStyle="#5A5A5A"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==35){ctx1.fillStyle="#555555"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==36){ctx1.fillStyle="#505050"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==37){ctx1.fillStyle="#4B4B4B"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==38){ctx1.fillStyle="#464646"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==39){ctx1.fillStyle="#414141"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==40){ctx1.fillStyle="#3C3C3C"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==41){ctx1.fillStyle="#373737"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==42){ctx1.fillStyle="#323232"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==43){ctx1.fillStyle="#2D2D2D"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==44){ctx1.fillStyle="#282828"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==45){ctx1.fillStyle="#232323"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==46){ctx1.fillStyle="#1E1E1E"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==47){ctx1.fillStyle="#191919"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==48){ctx1.fillStyle="#141414"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==49){ctx1.fillStyle="#0F0F0F"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==50){ctx1.fillStyle="#0A0A0A"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==51){ctx1.fillStyle="#050505"; ctx1.fillRect(xx,yy,1,1);}
			else if (mapArrayDisplay[x][y]==101){ctx1.fillStyle="#C2B280"; ctx1.fillRect(xx,yy,1,1);}	//	sand
			else if (mapArrayDisplay[x][y]==888){ctx1.fillStyle="#00FF00"; ctx1.fillRect(xx,yy,1,1);}	//	nuclear green
			else if (mapArrayDisplay[x][y]==0.5){ctx1.fillStyle="#FF6C00"; ctx1.fillRect(xx,yy,1,1);}	//	orange
			else if (mapArrayDisplay[x][y]==0.6){ctx1.fillStyle="#FF6C00"; ctx1.fillRect(xx,yy,1,1);}	//	orange
			else if (mapArrayDisplay[x][y]==0.7){ctx1.fillStyle="#FF6C00"; ctx1.fillRect(xx,yy,1,1);}	//	orange
			else if (mapArrayDisplay[x][y]==0.8){ctx1.fillStyle="#4f69aa"; ctx1.fillRect(xx,yy,1,1);}	// light blue
			else if (mapArrayDisplay[x][y]==0.9){ctx1.fillStyle="#4f69aa"; ctx1.fillRect(xx,yy,1,1);}	// light blue
			else if (mapArrayDisplay[x][y]==0.95){ctx1.fillStyle="#4f69aa"; ctx1.fillRect(xx,yy,1,1);}	// light blue
		//	else                             {ctx1.fillStyle="#000000"; ctx1.fillRect(xx,yy,1,1);}
			else                             {}

		/*
				182c65 deep water		0
				4f69aa shallow water	902
				18336f mid water		903
				a3ccff river			901

				#0099ff shallow water
				#0033ff deep water
				#ffcc66 sand
				#0099ff shallow water
				#ffa500 lava
				#61300d burned land
				#C1C1A1 hills scrub
				#1D8B13 trees polar
				#008100 scrub polar
				#007700 tundra long
				#006900 tundra
				#E0E0D0 low mountains lush
				#C1C1A1 hills lush
				#4B9032 rainforest
				#E5E5E5 ice
				#80DA80 boreal polar
		*/

			if (y==1000 && x==1000 && doPlotVolcanoes==2)
			{
				doPlotVolcanoes = 0;
//				constructorError.value = constructorError.value + "\nCompleted the loop. X:"+x+", Y:"+y;
			}

			if (y==1000 && x==1000)
			{
				constructorError.value = constructorError.value + "Completed draw.";
				doDrawTheWorld = 3;
			}
		}
	}
}

function showWidth()
{
	widthTextArea.value=widthSlider.value;
}

function showHeight()
{
	heightTextArea.value=heightSlider.value;
}

function showElevations()
{
	elevationsTextArea.value=elevationsSlider.value;
	setGrowthCurve();
}

function showNumMtnRanges()
{
	numMtnRangesTextArea.value=numMtnRangesSlider.value;
}

function showMaxMtnLength()
{
	maxMtnLengthTextArea.value=maxMtnLengthSlider.value;
}

function showMaxMtnGirth()
{
	maxMtnGirthTextArea.value=maxMtnGirthSlider.value;
	setGrowthCurve();
}

function showNumHillRanges()
{
	numHillRangesTextArea.value=numHillRangesSlider.value;
}

function showMaxHillLength()
{
	maxHillLengthTextArea.value=maxHillLengthSlider.value;
}

function showMaxHillGirth()
{
	maxHillGirthTextArea.value=maxHillGirthSlider.value;
}

function showHillCurvyness()
{
	hillCurvynessTextArea.value=hillCurvynessSlider.value;
}

function showLandSlope()
{
	landSlopeTextArea.value=landSlopeSlider.value;
//	setGrowthCurve();
}

function showNumVolcanoes()
{
	numVolcanoesTextArea.value=numVolcanoesSlider.value;
}

function showMaxVolcanoSize()
{
	maxVolcanoSizeTextArea.value=maxVolcanoSizeSlider.value;
}

function showLandUniformity()
{
	landUniformityTextArea.value=landUniformitySlider.value;
}

function showBrushSize()
{
	brushSizeTextArea.value=brushSizeSlider.value;
}

function showRandomLand()
{
	randomLandTextArea.value=randomLandSlider.value;
}

function showWaterLevel()
{
	waterLevelTextArea.value=waterLevelSlider.value;
}

function showHillMultiplier()
{
	hillMultiplierTextArea.value=hillMultiplierSlider.value;
//	setHillMultiplier();
}

function showNumRivers()
{
	addRiversTextArea.value=addRiversSlider.value;
}

function showNumShallows()
{
	addShallowsTextArea.value=addShallowsSlider.value;
}

function showBeachRadius()
{
	beachRadiusTextArea.value=beachRadiusSlider.value;
}

function showBeachDensity()
{
	beachDensityTextArea.value=beachDensitySlider.value;
}

function showNumLavaFlows()
{
	addLavaFlowsTextArea.value=addLavaFlowsSlider.value;
}

function showLavaCurvyness()
{
	lavaCurvynessTextArea.value=lavaCurvynessSlider.value;
}

function showRiverCurvyness()
{
	riverCurvynessTextArea.value=riverCurvynessSlider.value;
}

function setGrowthCurve()
{
	for (x=1;x<=30;x++)
	{
		growth[x] = (growth[x-1] * (landSlopeSlider.value / 100)) + (Math.round(maxMtnGirthSlider.value / 2))
//		growth[x] = (growth[x-1] * (landSlopeSlider.value / 100)) + (Math.round(maxMtnGirthSlider.value / 2)) - growth[x-1];
//		builderError.value=builderError.value+"\n"+x+ "\t" +Math.round(growth[x]);
	}

//	growth2[1] = 1
//	growth[1] = (growth2[1]-0) + (maxMtnGirthSlider.value-0);
//	growth[1] = maxMtnGirthSlider.value;
//	growth[1] = Math.round(maxMtnGirthSlider.value / 2);

//	negativeGrowth = (Math.round(.5 * growth[1]))-1;

//	builderError.value=builderError.value+"\n1\t"+Math.round(growth[1])+"\t"+Math.round(.5 * growth[1])+"\t"+negativeGrowth;

//	for (x=2;x<=(elevationsSlider.value);x++)
//	{
//		growth2[x] = (growth2[(x-1)] * (landSlopeSlider.value / 100));
//		growth[x] = (growth2[x]-0)+(maxMtnGirthSlider.value-0);
//		growth[x] = (growth[(x-1)] * (landSlopeSlider.value / 100));
//		growth[x] = (growth[(x-1)] * (landSlopeSlider.value / 100)) + Math.round(maxMtnGirthSlider.value / 2);
//		growth[x] = ((growth[x-1])-0) + ((growth[1])-0);

//		builderError.value=builderError.value+"\n"+x+ "\t" +Math.round(growth[x])+"\t"+Math.round(.5 * growth[x]);
//	}

//	growth[1] = growth[1] + maxMtnGirthSlider.value;

//	var canvasThing=document.getElementById("slopeDisplay");			UNCOMMENT THIS LINE!

//	var cxt=canvasThing.getContext("2d");								UNCOMMENT THIS LINE!

//	cxt.fillRect(0,0,(2 * Math.round(growth[x])),2);
//	builderError.value="";
//	cxt.fillStyle="#000000";
//	cxt.clearRect(0,0,500,30);
	for (x=1;x<=30;x++)
	{
//		builderError.value=builderError.value+growth[x]+ "\t" +Math.round(growth[x])+"\n";

//		cxt.fillRect
		(

		//	x,
		//	y,
		//	width,
		//	height

			(250-(Math.round(growth[x]))),
			(x-1),
			(2*(Math.round(growth[x]))),
			(1)
		);

	}
//	builderError.scrollTop = builderError.scrollHeight;
}

function mouseDown()
{
	mouseIsDown = 1;
//	builderError.value = builderError.value + "\nFiring changeBox()...";
	changeBox();
}

function mouseUp()
{
	mouseIsDown = 0;
}

function mouseMove()
{
	if (mouseIsDown==1)
	{
		changeBox();
	}
}

function mouseOver()
{
	if (mouseIsDown==1)
	{
		changeBox();
	}
}

function changeBox()
{
	brushSize = brushSizeSlider.value;

	brushRadius = (Math.round(brushSize / 2)) - 1;
	brushRadiusNeg = brushRadius - (2 * brushRadius);

	for (y = brushRadiusNeg; y <= brushRadius; y++)
	{
		for (x = brushRadiusNeg; x <= brushRadius; x++)
		{

			if ((changeX+x) < 1 || (changeX+x) > 100 || (changeY+y) < 1 || (changeY+y) > 100)
			{

			}
			else
			{
				if (drawingLand==1)
				{
					if ((x * x) + (y * y) <= (brushRadius * brushRadius))
					{
						document.getElementById("checkboxx"+(changeX+x)+"y"+(changeY+y)).style.background="url(boxgreen10.png) no-repeat";
						boxAddressArray[changeX+x][changeY+y] = "land";
				//		builderError.value = builderError.value + "\nChanging box "+(changeX+x)+","+(changeY+y)+" to land.";
					}
					else
					{

					}
				}
				else
				{
					if ((x * x) + (y * y) <= (brushRadius * brushRadius))
					{
						document.getElementById("checkboxx"+(changeX+x)+"y"+(changeY+y)).style.background="url(boxblue10.png) no-repeat";
						boxAddressArray[changeX+x][changeY+y] = "ocean";
					}
					else
					{

					}
				}
			}
		}
	}
}

function hillsConfined()
{
	confineHills = 1;
	document.getElementById("hillsConfined").style.background="url(checked.png) no-repeat";
	document.getElementById("hillsWild").style.background="url(unchecked.png) no-repeat";
	builderError.value += "\nHilltops are confined to selected land areas.";
	builderError.scrollTop = builderError.scrollHeight;
}

function hillsWild()
{
	confineHills = 0;
	document.getElementById("hillsConfined").style.background="url(unchecked.png) no-repeat";
	document.getElementById("hillsWild").style.background="url(checked.png) no-repeat";
	builderError.value += "\nHilltops are wild and free!";
	builderError.scrollTop = builderError.scrollHeight;
}

function clearAll()
{
	builderError.value += "\nClear ALL land.";
	builderError.scrollTop = builderError.scrollHeight;
	for (y=1;y<=100;y++)
	{
		for (x=1;x<=100;x++)
		{
			document.getElementById("checkboxx"+(x)+"y"+(y)).style.background="url(boxblue10.png) no-repeat";
			boxAddressArray[x][y] = "ocean";
		}
	}
	drawingLand=1;
	buttonEraseLand.disabled=false;
	buttonDrawLand.disabled=true;
}

function toggleEraseLand()
{
	drawingLand=0;
	buttonEraseLand.disabled=true;
	buttonDrawLand.disabled=false;
	builderError.value += "\nERASE land.";
	builderError.scrollTop = builderError.scrollHeight;
}

function toggleDrawLand()
{
	drawingLand=1;
	buttonEraseLand.disabled=false;
	buttonDrawLand.disabled=true;
	builderError.value += "\nDRAW land.";
	builderError.scrollTop = builderError.scrollHeight;
}

function continueFromConstructor()
{
	//	DETERMINE WATER LEVEL

	waterLevel = Math.round(z/2);

	waterLevelSlider.value = waterLevel;
	waterLevelSlider.max = z;
	waterLevelTextArea.value = waterLevel;

	document.getElementById("divConstructor").style.display="none";
	document.getElementById("divConstructorStage2").style.display="block";

	//	LOAD WATERMAPDISPLAY

	drawingWater = 1;
	//	doCopyWorldArray = 1;
	//	doLoadDisplayArray = 1;
	doSetWaterLevel = 1;

	lavaFlowsSlider.value = (numVolcanoesTextArea.value * 2);
	lavaFlowsTextArea.value = (numVolcanoesTextArea.value * 2);
}

function changeWaterLevel()
{
	waterLevel = waterLevelTextArea.value;
	doSetWaterLevel = 1;
}

function showWaterLevel()
{
	waterLevelTextArea.value=waterLevelSlider.value;
}

function showNumShallows()
{
	addShallowsTextArea.value=addShallowsSlider.value;
}

function addShallows()
{
	constructor2Error.value += "\nGot to addShallows();";
	for (y=1;y<=mapSizeX;y++)
	{
		for (x=1;x<=mapSizeX;x++)
		{
			if (mapArrayDev[x][y]==0)
			{

				somethingAjacent = 0;

				for (yy=(-1);yy<=1;yy++)
				{
					for (xx=(-1);xx<=1;xx++)
					{
						if ((x+xx) < 1)
						{
							xxx = mapSizeX;
						}
						else if ((x+xx) > mapSizeX)
						{
							xxx = 1;
						}
						else
						{
							xxx = ((x-0)+(xx-0));
						}

						if ((y+yy) < 1)
						{
							yyy = mapSizeY;
						}
						else if ((y+yy) > mapSizeY)
						{
							yyy = 1;
						}
						else
						{
							yyy = ((y-0)+(yy-0));
						}

						if (mapArrayDev[xxx][yyy] != 0)
						{
							somethingAjacent = 1;
							yy = 1;
							xx = 1;
//							constructor2Error.value += "\nSomething ajacent.";
						}
					}
				}
				if (somethingAjacent == 1)
				{
					mapArrayDev[x][y] = (-1);
//					constructor2Error.value += "\nPrinting a Q.";
					somethingAjacent = 0;
				}

/*

							   -----
								111







*/

//				else
//				{
//					mapArrayDev[x][y] = mapArrayWorld[x][y];
//				}
			}
//			else
//			{
//				mapArrayDev[x][y] = mapArrayWorld[x][y];
//			}
			if (y==mapSizeY && x==mapSizeX)
			{
				doAddShallows = 3;
			}
		}
	}
	//	doLoadDisplayArray = 1;
}

function duplicateWorldArray()
{
	for (y=1;y<=mapSizeY;y++)
	{
		for (x=1;x<=mapSizeX;x++)
		{
			mapArrayDev[x][y] = mapArrayWorld[x][y];
			if (y==mapSizeY && x==mapSizeX)
			{
				doCopyWorldArray = 3;
			}
		}
	}
}

function setWaterLevel()
{
	drawingWater = 1;
	constructor2Error.value += "waterLevel = "+waterLevel+"...";
	getTime();
	constructor2Error.value += "\n["+timeText+"] - Duplicating mapArrayWorld to mapArrayDev...";
	for (y=1;y<=mapSizeY;y++)
	{
		for (x=1;x<=mapSizeX;x++)
		{
			mapArrayDev[x][y] = mapArrayWorld[x][y];
			if (y==mapSizeY && x==mapSizeX)
			{
				constructor2Error.value += "Done.";
			}
		}
	}

//	constructor2Error.value += "\n***  waterLevel+5 = "+(waterLevel+5)+"  ***";

	for (y=1;y<=mapSizeY;y++)
	{
		for (x=1;x<=mapSizeX;x++)
		{
			if (mapArrayDev[x][y] >= waterLevel && mapArrayDev[x][y] < 100)
			{
				if (mapArrayDev[x][y]==waterLevel)
				{
					mapArrayDev[x][y] = 0;
				}
				else if (mapArrayDev[x][y]==((waterLevel-0)+1))
				{
					mapArrayDev[x][y] = (-1);
				}
				else if (mapArrayDev[x][y]>=((waterLevel-0)+2))
				{
					mapArrayDev[x][y] = (-2);
				}
			}
			if (y==mapSizeY && x==mapSizeX)
			{
				doSetWaterLevel = 3;
			}
		}
	}
}

function addBeaches()
{
	addingBeaches = 1;
	beachRadius = beachRadiusTextArea.value;
	beachDensity = beachDensityTextArea.value;
//	beachRadius = 4;
	negativeBeachRadius = beachRadius * (-1);

	for (y=1;y<=mapSizeY;y++)
	{
		for (x=1;x<=mapSizeX;x++)
		{
			randomNumber = Math.floor(Math.random()*100)+1;

			if (mapArrayDev[x][y]==(waterLevel-1) && randomNumber < beachDensity)
			{
	//			constructor2Error.value += "\nFound land one level above the water!";

				for (q=(-1);q<=1;q++)
				{
					s=q;
					for (p=(-1);p<=1;p++)
					{
						r=p;

	//	NOTE WELL!!! THERE MAY NOT BE FIRST TIER SHALLOWS DIRECTLY NEXT TO LAND!!!

						if ((x + r) < 1)
						{
							r = (mapSizeX-1);
						}
						else if ((x + r) > mapSizeX)
						{
							r = (mapSizeX * (-1))+1;
						}

						if ((y + s) < 1)
						{
							s = (mapSizeY-1);
						}
						else if ((y + s) > mapSizeY)
						{
							s = (mapSizeY * (-1))+1;
						}

						var xx=x+r;
						var yy=y+s;

				//		constructor2Error.value += "\nTesting: [(x-0)+(r-0)][(y-0)+(s-0)]: ["+(x-0)+(r-0)+"]["+(y-0)+(s-0)+"]: "+mapArrayDev[(x-0)+(r-0)][(y-0)+(s-0)];
				//		constructor2Error.value += "\nTesting: [xx][yy]: ["+xx+"]["+yy+"]: "+mapArrayDev[xx][yy];

						if (mapArrayDev[xx][yy] == 0)
						{
				//			constructor2Error.value += "\nFound a piece of land at the edge of the ocean!"
							edgeOfOcean = 1;
						}
					}
				}
			}

			if (edgeOfOcean==1)
			{
				edgeOfOcean = 0;
		//		constructor2Error.value += "\nInside edgeOfOcean!";

		//		constructor2Error.value += ".";
		//		mapArrayDev[x][y] = 101;

				for (q=negativeBeachRadius;q<=beachRadius;q++)
				{
					s=q;
					for (p=negativeBeachRadius;p<=beachRadius;p++)
					{
						r=p;
						if ((Math.abs((r * r)+(s * s))) <= ((beachRadius) * (beachRadius)))
						{
				//			constructor2Error.value += "\nInside circle!";


							if ((x + r) < 1)
							{
								r = (mapSizeX-1);
							}
							else if ((x + r) > mapSizeX)
							{
								r = (mapSizeX * (-1))+1;
							}

							if ((y + s) < 1)
							{
								s = (mapSizeY-1);
							}
							else if ((y + s) > mapSizeY)
							{
								s = (mapSizeY * (-1))+1;
							}


							try
							{
								if (mapArrayDev[(x-0)+(r-0)][(y-0)+(s-0)] == (waterLevel-0)-1)
								{
					//				constructor2Error.value += "\nDrawing beach!";
									mapArrayDev[(x-0)+(r-0)][(y-0)+(s-0)] = 101;
								}
							}
							catch(err)
							{
								constructor2Error.value += "***ERROR*** - addBeaches() - Evaluating [x+r][y+s] as: ["+x+"+"+r+"]["+y+"+"+s+"]";
							}
						}
					}
				}
			}

			if (y==mapSizeY && x==mapSizeX)
			{
				constructor2Error.value += "\n\ndoAddBeaches = 3...\n\n";
				doAddBeaches = 3;
			}
		}
	}
}

function changeRiverWidth()
{
	if (riversRegular==1)
	{
		document.getElementById("buttonRiversRegular").style.background="url(checked.png) no-repeat";
		document.getElementById("buttonRiversWide").style.background="url(unchecked.png) no-repeat";
		constructor2Error.value += "\n[Rivers regular.]";
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
	}
	else
	{
		document.getElementById("buttonRiversRegular").style.background="url(unchecked.png) no-repeat";
		document.getElementById("buttonRiversWide").style.background="url(checked.png) no-repeat";
		constructor2Error.value += "\n[Rivers wide.]";
		constructor2Error.scrollTop = constructor2Error.scrollHeight;
	}
}

function fattenRivers()
{
//	constructor2Error.value += "\nriversRegular = "+riversRegular;

	for (y=1;y<=mapSizeY;y++)
	{
		for (x=1;x<=mapSizeX;x++)
		{
			if (riversRegular==1 && thisIsLava==1)
			{
				//	REGULAR

		//		 R
		//		RXR
		//		 R

				if (mapArrayDev[x][y]==0.6)
				{
					if (mapArrayDev[x][y-1] != 0.6)			{mapArrayDev[x][y-1] = 0.5;}

					if (mapArrayDev[x-1][y] != 0.6)			{mapArrayDev[x-1][y] = 0.5;}
					if (mapArrayDev[x+1][y] != 0.6)			{mapArrayDev[x+1][y] = 0.5;}

					if (mapArrayDev[x][y+1] != 0.6)			{mapArrayDev[x][y+1] = 0.5;}
				}

		//		 RR
		//		RXRR
		//		RRRR
		//		 RR

				else if (mapArrayDev[x][y]==0.7)
				{
					if (mapArrayDev[x][y-1] != 0.7)			{mapArrayDev[x][y-1] = 0.5;}
					if (mapArrayDev[x+1][y-1] != 0.7)		{mapArrayDev[x+1][y-1] = 0.5;}

					if (mapArrayDev[x-1][y] != 0.7)			{mapArrayDev[x-1][y] = 0.5;}
					if (mapArrayDev[x+1][y] != 0.7)			{mapArrayDev[x+1][y] = 0.5;}
					if (mapArrayDev[x+2][y] != 0.7)			{mapArrayDev[x+2][y] = 0.5;}

					if (mapArrayDev[x-1][y+1] != 0.7)		{mapArrayDev[x-1][y+1] = 0.5;}
					if (mapArrayDev[x][y+1] != 0.7)			{mapArrayDev[x][y+1] = 0.5;}
					if (mapArrayDev[x+1][y+1] != 0.7)		{mapArrayDev[x+1][y+1] = 0.5;}
					if (mapArrayDev[x+2][y+1] != 0.7)		{mapArrayDev[x+2][y+1] = 0.5;}

					if (mapArrayDev[x][y+2] != 0.7)			{mapArrayDev[x][y+2] = 0.5;}
					if (mapArrayDev[x+1][y+2] != 0.7)		{mapArrayDev[x+1][y+2] = 0.5;}
				}
			}
			else if (riversRegular==1 && thisIsLava==0)
			{
				//	REGULAR

		//		 R
		//		RXR
		//		 R

		//	constructor2Error.value += ".";

				if (mapArrayDev[x][y]==0.8)
				{
					if (mapArrayDev[x][y-1] != 0.8)			{mapArrayDev[x][y-1] = 0.95;}

					if (mapArrayDev[x-1][y] != 0.8)			{mapArrayDev[x-1][y] = 0.95;}
					if (mapArrayDev[x+1][y] != 0.8)			{mapArrayDev[x+1][y] = 0.95;}

					if (mapArrayDev[x][y+1] != 0.8)			{mapArrayDev[x][y+1] = 0.95;}
				}

		//		 RR
		//		RXRR
		//		RRRR
		//		 RR

				else if (mapArrayDev[x][y]==0.9)
				{
					if (mapArrayDev[x][y-1] != 0.9)			{mapArrayDev[x][y-1] = 0.95;}
					if (mapArrayDev[x+1][y-1] != 0.9)		{mapArrayDev[x+1][y-1] = 0.95;}

					if (mapArrayDev[x-1][y] != 0.9)			{mapArrayDev[x-1][y] = 0.95;}
					if (mapArrayDev[x+1][y] != 0.9)			{mapArrayDev[x+1][y] = 0.95;}
					if (mapArrayDev[x+2][y] != 0.9)			{mapArrayDev[x+2][y] = 0.95;}

					if (mapArrayDev[x-1][y+1] != 0.9)		{mapArrayDev[x-1][y+1] = 0.95;}
					if (mapArrayDev[x][y+1] != 0.9)			{mapArrayDev[x][y+1] = 0.95;}
					if (mapArrayDev[x+1][y+1] != 0.9)		{mapArrayDev[x+1][y+1] = 0.95;}
					if (mapArrayDev[x+2][y+1] != 0.9)		{mapArrayDev[x+2][y+1] = 0.95;}

					if (mapArrayDev[x][y+2] != 0.9)			{mapArrayDev[x][y+2] = 0.95;}
					if (mapArrayDev[x+1][y+2] != 0.9)		{mapArrayDev[x+1][y+2] = 0.95;}
				}
			}
			else
			{
				//	PHAT!
			}

			if (y==mapSizeY && x==mapSizeX)
			{
				if (thisIsLava==1)
				{
					doAddLavaFlows = 5;
				}
				else
				{
					doAddRivers = 5;
				}
			}
		}
	}
}

function addRivers()
{
	goodRiverStartPoint = 0;

	var riverPointCount = 0;

	while (goodRiverStartPoint == 0 && riverPointCount < 10000)
	{
		riverX = Math.floor(Math.random()*mapSizeX)+1;
		riverY = Math.floor(Math.random()*mapSizeY)+1;

		riverPointCount = riverPointCount + 1;

		/*
			ACCEPTABLE START LEVELS

			if waterLevel is 10, high should be 3, low should be 7

			if waterLevel is 20, high should be 3, low should be 15
		*/

		acceptableHighStartLevel = 3;
		acceptableLowStartLevel = waterLevel * Math.round(waterLevel * .75);

		if (mapArrayDev[riverX][riverY] >= acceptableHighStartLevel && mapArrayDev[riverX][riverY] <= acceptableLowStartLevel)
		{
			goodRiverStartPoint = 1;
		}
	}

	if (goodRiverStartPoint==1)
	{
		constructor2Error.value += "\n["+timeText+"] - River added from: ["+riverX+"]["+riverY+"]";
		constructor2Error.scrollTop = constructor2Error.scrollHeight;

		//	PICK INITIAL FLOW DIRECTION

		oldFlowDirection = Math.floor(Math.random()*8)+1;
		oldRiverDirection = oldFlowDirection;

		plotRiver();

		pickRiverDirection();

		riversCount = riversCount - 1;
		if (riversCount > 0)
		{
			doAddRivers = 2;
		}
		else
		{
			doAddRivers = 3;
		}
	}
	else
	{
		constructor2Error.value += "\n["+timeText+"] - No good river start found!";
		constructor2Error.scrollTop = constructor2Error.scrollHeight;

		riversCount = riversCount - 1;
		if (riversCount > 0)
		{
			doAddRivers = 2;
		}
		else
		{
			doAddRivers = 3;
		}
	}
}

function addLavaFlows()
{
	//	SELECT A VOLCANO POINT

	//	volcanoCount = number of volcanoes plotted
	//	volcanoXArray
	//	volcanoYArray

	selectedVolcano = Math.floor(Math.random()*volcanoCount)+1;

	flowX = volcanoXArray[selectedVolcano];
	flowY = volcanoYArray[selectedVolcano];

	getTime();
	constructor2Error.value += "\n["+timeText+"] - Lava flow added from: ["+flowX+"]["+flowY+"]";
	constructor2Error.scrollTop = constructor2Error.scrollHeight;

	//	PICK INITIAL FLOW DIRECTION

	oldFlowDirection = Math.floor(Math.random()*8)+1;
	oldRiverDirection = oldFlowDirection;

	thisIsLava = 1;

	riverX = flowX;
	riverY = flowY;

	plotRiver();

	pickRiverDirection();

	thisIsLava = 0;

	flowX = riverX;
	flowY = riverY;

/*

//	constructor2Error.value += "\nAdding burn zone.";
//	constructor2Error.scrollTop = constructor2Error.scrollHeight;

	for (y=1;y<=mapSizeY;y++)
	{
		for (x=1;x<=mapSizeX;x++)
		{
			if (mapArrayDev2[x][y]=="*")
			{
				for (def=(-1);def<=1;def++)
				{
					jkl = def;
					for (abc=(-1);abc<=1;abc++)
					{
						ghi = abc;
						if (def==0 && abc==0)
						{

						}
						else
						{
							try
							{
								if ((x+ghi) < 1)
								{
									ghix = mapSizeX;
								}
								else if ((x+ghi) > mapSizeX)
								{
									ghix = 1;
								}
								else
								{
									ghix = ((x-0)+(ghi-0));
								}

								if ((y+jkl) < 1)
								{
									jklx = mapSizeY;
								}
								else if ((y+jkl) > mapSizeY)
								{
									jklx = 1;
								}
								else
								{
									jklx = ((y-0)+(jkl-0));
								}

								if (mapArrayDev2[ghix][jklx] != "*" &&
									mapArrayDev2[ghix][jklx] != "-" &&
									mapArrayDev2[ghix][jklx] != "R" &&
									mapArrayDev2[ghix][jklx] != "X" &&
									mapArrayDev2[ghix][jklx] != "a" &&
									mapArrayDev2[ghix][jklx] != "b" &&
									mapArrayDev2[ghix][jklx] != "Q")
								{
									mapArrayDev2[ghix][jklx] = "-";
								//	constructor2Error.value += "\nAdded burned tile at "+((x-0)+(ghix-0))+","+((y-0)+(jklx-0))+".";
								//	constructor2Error.scrollTop = constructor2Error.scrollHeight;
								}
							}
							catch(err)
							{
								constructor2Error.value += "\nERROR (addLavaFlow): x:"+x+", ghix:"+ghix+", y:"+y+", jklx:"+jklx;
								constructor2Error.scrollTop = constructor2Error.scrollHeight;
							}
						}
					}
				}
			}
		}
	}
*/
	lavaFlowsCount = lavaFlowsCount - 1;
	if (lavaFlowsCount > 0)
	{
		doAddLavaFlows = 2;
	}
	else
	{
		doAddLavaFlows = 3;
	}
}

function plotRiver()
{
	if (mapArrayDev[riverX][riverY]==0.5)
	{
		flowValue = 0.5;
	}
	else
	{
		if (mapArrayDev[riverX][riverY] <= (waterLevel/2))
		{
			if (thisIsLava==1)
			{
				flowValue = 0.6;
			}
			else
			{
				flowValue = 0.8;
			}
		}
		else
		{
			if (thisIsLava==1)
			{
				flowValue = 0.7;
			}
			else
			{
				flowValue = 0.9;
			}
		}
	}

	mapArrayDev[riverX][riverY] = flowValue;
//	constructor2Error.value += "\n["+timeText+"] - Plotting flow value: "+flowValue;
//	constructor2Error.scrollTop = constructor2Error.scrollHeight;
}

function pickRiverDirection()
{
	riverEnd = 0;
	riverTries = 0;

	var riverSteps = 0;

	while (riverEnd==0)
	{

		riverSteps = riverSteps + 1;

//		if (riverSteps==100)
//		{
//			riverEnd = 1;
//		}

		var checkedTileValue = new Array(8);
		var directionOkay = new Array(8);

		for (x=1;x<=8;x++)
		{
			directionOkay[x] = 0;
		}

		try
		{
			landTile = mapArrayDev[riverX][riverY];
		}
		catch(err)
		{
			constructor2Error.value += "\nERROR (pickRiverDirection, 653): "+riverX+","+riverY;
			constructor2Error.scrollTop = constructor2Error.scrollHeight;
		}

//		setTileValue();
		landTileValue = (mapArrayDev[riverX][riverY]);
		centralTileValue = landTileValue;

	//	constructor2Error.value += "\nPosition: 0, Character: "+landTile+", Value: "+landTileValue;
	//	constructor2Error.scrollTop = constructor2Error.scrollHeight;

		tilePosition = 1;

		//	CHECK AJACENT TILES

/*
		1	2	3

		4		5

		6	7	8
*/

		waterAjacent = 0;

		for (y=(-1);y<=1;y++)
		{
			yb = y;
			for (x=(-1);x<=1;x++)
			{

				if (y==0 && x==0)
				{
					x = 1;
				}

				xb = x;

				if ((riverX + xb) < 1)
				{
					xb = (mapSizeX - 1);
				}
				else if ((riverX + xb) > mapSizeX)
				{
					xb = ((mapSizeX * (-1)) + 1);
				}

				if ((riverY + yb) < 1)
				{
					yb = (mapSizeY - 1);
				}
				else if ((riverY + yb) > mapSizeY)
				{
					yb = ((mapSizeY * (-1)) + 1);
				}

				try
				{
					landTile = mapArrayDev[((riverX-0)+(xb-0))][((riverY-0)+(yb-0))];
				}
				catch(err)
				{
					constructor2Error.value += "\nERROR (pickRiverDirection, 706): "+(riverX+xb)+","+(riverY+yb);
					constructor2Error.scrollTop = constructor2Error.scrollHeight;
				}

				//	IS AJACENT TILE WATER?

				if (landTile==0 || landTile==(-1) || landTile==1.6)
				{
					waterAjacent = 1;
				}
				else
				{
					landTileValue = (mapArrayDev[((riverX-0)+(xb-0))][((riverY-0)+(yb-0))]);
					checkedTileValue[tilePosition] = landTileValue;
				//	constructor2Error.value += "\ntilePosition "+tilePosition+": "+landTileValue;
				//	constructor2Error.scrollTop = constructor2Error.scrollHeight;

			//		if (checkedTileValue[tilePosition] > 0.5 && checkedTileValue[tilePosition] < 1)
			//		{
			//			checkedTileValue[tilePosition] = 1;
			//		}

				//	constructor2Error.value += "\nPosition: "+tilePosition+", Character: "+landTile+", Value: "+landTileValue;
				//	constructor2Error.scrollTop = constructor2Error.scrollHeight;
				}
				tilePosition = tilePosition + 1;
			}
		}
		if (waterAjacent==1)
		{
			riverEnd = 1;
		//	constructor2Error.value += "\nWater ajacent!";
		//	constructor2Error.scrollTop = constructor2Error.scrollHeight;
		}
		else if (riverTries == 1000)
		{
			riverEnd = 1;
			constructor2Error.value += "\nIn a hole!";
			constructor2Error.scrollTop = constructor2Error.scrollHeight;
		}
		else
		{
			riverTries += 1;

			//	SET LOWEST TILE VALUE

			lowestTileValue = centralTileValue;

			if (checkedTileValue[1] > centralTileValue)
			{
				lowestTileValue = checkedTileValue[1];
			//	constructor2Error.value += "\nlowest direction = 1";
			}

			if (checkedTileValue[2] > centralTileValue &&
				checkedTileValue[2] > checkedTileValue[1])
			{
				lowestTileValue = checkedTileValue[2];
			//	constructor2Error.value += "\nlowest direction = 2";
			}
			if (checkedTileValue[3] > centralTileValue &&
				checkedTileValue[3] > checkedTileValue[1] &&
				checkedTileValue[3] > checkedTileValue[2])
			{
				lowestTileValue = checkedTileValue[3];
			//	constructor2Error.value += "\nlowest direction = 3";
			}
			if (checkedTileValue[4] > centralTileValue &&
				checkedTileValue[4] > checkedTileValue[1] &&
				checkedTileValue[4] > checkedTileValue[2] &&
				checkedTileValue[4] > checkedTileValue[3])
			{
				lowestTileValue = checkedTileValue[4];
			//	constructor2Error.value += "\nlowest direction = 4";
			}
			if (checkedTileValue[5] > centralTileValue &&
				checkedTileValue[5] > checkedTileValue[1] &&
				checkedTileValue[5] > checkedTileValue[2] &&
				checkedTileValue[5] > checkedTileValue[3] &&
				checkedTileValue[5] > checkedTileValue[4])
			{
				lowestTileValue = checkedTileValue[5];
			//	constructor2Error.value += "\nlowest direction = 5";
			}
			if (checkedTileValue[6] > centralTileValue &&
				checkedTileValue[6] > checkedTileValue[1] &&
				checkedTileValue[6] > checkedTileValue[2] &&
				checkedTileValue[6] > checkedTileValue[3] &&
				checkedTileValue[6] > checkedTileValue[4] &&
				checkedTileValue[6] > checkedTileValue[5])
			{
				lowestTileValue = checkedTileValue[6];
			//	constructor2Error.value += "\nlowest direction = 6";
			}
			if (checkedTileValue[7] > centralTileValue &&
				checkedTileValue[7] > checkedTileValue[1] &&
				checkedTileValue[7] > checkedTileValue[2] &&
				checkedTileValue[7] > checkedTileValue[3] &&
				checkedTileValue[7] > checkedTileValue[4] &&
				checkedTileValue[7] > checkedTileValue[5] &&
				checkedTileValue[7] > checkedTileValue[6])
			{
				lowestTileValue = checkedTileValue[7];
			//	constructor2Error.value += "\nlowest direction = 7";
			}
			if (checkedTileValue[8] > centralTileValue &&
				checkedTileValue[8] > checkedTileValue[1] &&
				checkedTileValue[8] > checkedTileValue[2] &&
				checkedTileValue[8] > checkedTileValue[3] &&
				checkedTileValue[8] > checkedTileValue[4] &&
				checkedTileValue[8] > checkedTileValue[5] &&
				checkedTileValue[8] > checkedTileValue[6] &&
				checkedTileValue[8] > checkedTileValue[7])
			{
				lowestTileValue = checkedTileValue[8];
			//	constructor2Error.value += "\nlowest direction = 8";
			}

		//	else {constructor2Error.value += "\nNO LOWEST DIRECTION!";}

		//	constructor2Error.value += "\nlowest direction = "+lowestTileValue;

		//	constructor2Error.value += "\nlowestTileValue = "+lowestTileValue;
		//	constructor2Error.scrollTop = constructor2Error.scrollHeight;

			//	SET OKAYED DIRECTIONS

			for (x=1;x<=8;x++)
			{
				if (checkedTileValue[x] == lowestTileValue &&
				    (checkedTileValue[x] != 0.6 &&
				     checkedTileValue[x] != 0.7 &&
				     checkedTileValue[x] != 0.8 &&
				     checkedTileValue[x] != 0.9))
				{
					directionOkay[x] = 1;
				//	constructor2Error.value += "\ndirectionOkay["+x+"] = "+directionOkay[x];
				//	constructor2Error.scrollTop = constructor2Error.scrollHeight;
				}
			}

			if (thisIsLava==1)
			{
				curveChance = lavaCurvynessTextArea.value
			}
			else
			{
				curveChance = riverCurvynessTextArea.value;
			}

/*

	if the old direction is one of the lowest, then go the old direction
		for curvyness, check right and left
		if left or right is good, run a chance of turning
		if both left and right is good, turn on a chance
	if the right or left direction is one of the lowest, go right or left
	if both right and left are lowest, split the decision
	if none of the above work, try the right angle right or left
	if both the right angle right or left are lowest, split the decision

	1	2	3

	4		5

	6	7	8
*/

			if (oldRiverDirection==1)
			{
				directionStraight = 1;
				directionLeft = 4;
				directionRight = 2;
				directionHardLeft = 6;
				directionHardRight = 3;
				directionBackLeft = 7;
				directionBackRight = 5;
			}
			else if (oldRiverDirection==2)
			{
				directionStraight = 2;
				directionLeft = 1;
				directionRight = 3;
				directionHardLeft = 4;
				directionHardRight = 5;
				directionBackLeft = 6;
				directionBackRight = 8;
			}
			else if (oldRiverDirection==3)
			{
				directionStraight = 3;
				directionLeft = 2;
				directionRight = 5;
				directionHardLeft = 1;
				directionHardRight = 8;
				directionBackLeft = 4;
				directionBackRight = 7;
			}
			else if (oldRiverDirection==4)
			{
				directionStraight = 4;
				directionLeft = 6;
				directionRight = 1;
				directionHardLeft = 7;
				directionHardRight = 2;
				directionBackLeft = 8;
				directionBackRight = 3;
			}
			else if (oldRiverDirection==5)
			{
				directionStraight = 5;
				directionLeft = 3;
				directionRight = 8;
				directionHardLeft = 2;
				directionHardRight = 7;
				directionBackLeft = 1;
				directionBackRight = 6;
			}
			else if (oldRiverDirection==6)
			{
				directionStraight = 6;
				directionLeft = 7;
				directionRight = 4;
				directionHardLeft = 8;
				directionHardRight = 1;
				directionBackLeft = 5;
				directionBackRight = 2;
			}
			else if (oldRiverDirection==7)
			{
				directionStraight = 7;
				directionLeft = 8;
				directionRight = 6;
				directionHardLeft = 5;
				directionHardRight = 4;
				directionBackLeft = 3;
				directionBackRight = 1;
			}
			else if (oldRiverDirection==8)
			{
				directionStraight = 8;
				directionLeft = 5;
				directionRight = 7;
				directionHardLeft = 3;
				directionHardRight = 6;
				directionBackLeft = 2;
				directionBackRight = 4;
			}


			if (directionOkay[directionStraight] == 1 && oldRiverDirection == directionStraight)
			{
				if (directionOkay[directionLeft] == 1 && directionOkay[directionRight] == 0)		//	maybe left
				{
					randomNumber = Math.floor(Math.random()*100)+1;
					if (randomNumber < curveChance)
					{
						//	go left
						if (oldRiverDirection==1)			{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
						else if (oldRiverDirection==2)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
						else if (oldRiverDirection==3)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
						else if (oldRiverDirection==4)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
						else if (oldRiverDirection==5)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
						else if (oldRiverDirection==6)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
						else if (oldRiverDirection==7)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
						else if (oldRiverDirection==8)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
					//	constructor2Error.value += "\nleft";
					}
					else
					{
						//	go straight
						if (oldRiverDirection==1)			{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
						else if (oldRiverDirection==2)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
						else if (oldRiverDirection==3)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
						else if (oldRiverDirection==4)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
						else if (oldRiverDirection==5)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
						else if (oldRiverDirection==6)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
						else if (oldRiverDirection==7)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
						else if (oldRiverDirection==8)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
					//	constructor2Error.value += "\nstraight";
					}
				}
				else if (directionOkay[directionLeft] == 0 && directionOkay[directionRight] == 1)	//	maybe right
				{
					randomNumber = Math.floor(Math.random()*100)+1;
					if (randomNumber < curveChance)
					{
						//	go right
						if (oldRiverDirection==1)			{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
						else if (oldRiverDirection==2)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
						else if (oldRiverDirection==3)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
						else if (oldRiverDirection==4)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
						else if (oldRiverDirection==5)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
						else if (oldRiverDirection==6)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
						else if (oldRiverDirection==7)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
						else if (oldRiverDirection==8)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
					//	constructor2Error.value += "\nright";
					}
					else
					{
						//	go straight
						if (oldRiverDirection==1)			{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
						else if (oldRiverDirection==2)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
						else if (oldRiverDirection==3)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
						else if (oldRiverDirection==4)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
						else if (oldRiverDirection==5)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
						else if (oldRiverDirection==6)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
						else if (oldRiverDirection==7)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
						else if (oldRiverDirection==8)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
					//	constructor2Error.value += "\nstraight";
					}
				}
				else if (directionOkay[directionLeft] == 1 && directionOkay[directionRight] == 1)	//	maybe left or right
				{
					randomNumber = Math.floor(Math.random()*100)+1;
					if (randomNumber < curveChance)
					{
						randomNumber = Math.floor(Math.random()*100)+1;
						if (randomNumber < 51)
						{
							//	go left
							if (oldRiverDirection==1)			{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
							else if (oldRiverDirection==2)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
							else if (oldRiverDirection==3)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
							else if (oldRiverDirection==4)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
							else if (oldRiverDirection==5)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
							else if (oldRiverDirection==6)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
							else if (oldRiverDirection==7)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
							else if (oldRiverDirection==8)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
						//	constructor2Error.value += "\nleft";
						}
						else
						{
							//	go right
							if (oldRiverDirection==1)			{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
							else if (oldRiverDirection==2)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
							else if (oldRiverDirection==3)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
							else if (oldRiverDirection==4)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
							else if (oldRiverDirection==5)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
							else if (oldRiverDirection==6)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
							else if (oldRiverDirection==7)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
							else if (oldRiverDirection==8)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
						//	constructor2Error.value += "\nright";
						}
					}
					else
					{
						//	go straight
						if (oldRiverDirection==1)			{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
						else if (oldRiverDirection==2)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
						else if (oldRiverDirection==3)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
						else if (oldRiverDirection==4)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
						else if (oldRiverDirection==5)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
						else if (oldRiverDirection==6)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
						else if (oldRiverDirection==7)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
						else if (oldRiverDirection==8)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
					//	constructor2Error.value += "\nstraight";
					}
				}
				else																				//	going straight
				{
					//	straight
					if (oldRiverDirection==1)			{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
					else if (oldRiverDirection==2)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
					else if (oldRiverDirection==3)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
					else if (oldRiverDirection==4)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
					else if (oldRiverDirection==5)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
					else if (oldRiverDirection==6)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
					else if (oldRiverDirection==7)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
					else if (oldRiverDirection==8)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
				//	constructor2Error.value += "\nstraight";
				}

			}

			else if (directionOkay[directionStraight] == 0 && oldRiverDirection == directionStraight && directionOkay[directionLeft] == 1 && directionOkay[directionRight] == 0)
			{
				//	go left
				if (oldRiverDirection==1)			{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
				else if (oldRiverDirection==2)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
				else if (oldRiverDirection==3)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
				else if (oldRiverDirection==4)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
				else if (oldRiverDirection==5)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
				else if (oldRiverDirection==6)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
				else if (oldRiverDirection==7)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
				else if (oldRiverDirection==8)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
			//	constructor2Error.value += "\nleft";
			}
			else if (directionOkay[directionStraight] == 0 && oldRiverDirection == directionStraight && directionOkay[directionLeft] == 0 && directionOkay[directionRight] == 1)
			{
				//	go right
				if (oldRiverDirection==1)			{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
				else if (oldRiverDirection==2)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
				else if (oldRiverDirection==3)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
				else if (oldRiverDirection==4)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
				else if (oldRiverDirection==5)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
				else if (oldRiverDirection==6)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
				else if (oldRiverDirection==7)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
				else if (oldRiverDirection==8)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
			//	constructor2Error.value += "\nright";
			}
			else if (directionOkay[directionStraight] == 0 && oldRiverDirection == directionStraight && directionOkay[directionLeft] == 1 && directionOkay[directionRight] == 1)
			{
				randomNumber = Math.floor(Math.random()*100)+1;
				if (randomNumber < 51)
				{
					//	go left
					if (oldRiverDirection==1)			{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
					else if (oldRiverDirection==2)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
					else if (oldRiverDirection==3)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
					else if (oldRiverDirection==4)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
					else if (oldRiverDirection==5)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
					else if (oldRiverDirection==6)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
					else if (oldRiverDirection==7)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
					else if (oldRiverDirection==8)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
				//	constructor2Error.value += "\nleft";
				}
				else
				{
					//	go right
					if (oldRiverDirection==1)			{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
					else if (oldRiverDirection==2)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
					else if (oldRiverDirection==3)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
					else if (oldRiverDirection==4)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
					else if (oldRiverDirection==5)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
					else if (oldRiverDirection==6)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
					else if (oldRiverDirection==7)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
					else if (oldRiverDirection==8)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
				//	constructor2Error.value += "\nright";
				}
			}

			else if (directionOkay[directionStraight] == 0 && oldRiverDirection == directionStraight && directionOkay[directionHardLeft] == 1 && directionOkay[directionHardRight] == 0 && thisIsLava == 0)
			{
				//	go hard left
				if (oldRiverDirection==1)			{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
				else if (oldRiverDirection==2)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
				else if (oldRiverDirection==3)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
				else if (oldRiverDirection==4)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
				else if (oldRiverDirection==5)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
				else if (oldRiverDirection==6)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
				else if (oldRiverDirection==7)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
				else if (oldRiverDirection==8)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
			//	constructor2Error.value += "\nhard left";
			}
			else if (directionOkay[directionStraight] == 0 && oldRiverDirection == directionStraight && directionOkay[directionHardLeft] == 0 && directionOkay[directionHardRight] == 1 && thisIsLava == 0)
			{
				//	go hard right
				if (oldRiverDirection==1)			{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
				else if (oldRiverDirection==2)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
				else if (oldRiverDirection==3)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
				else if (oldRiverDirection==4)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
				else if (oldRiverDirection==5)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
				else if (oldRiverDirection==6)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
				else if (oldRiverDirection==7)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
				else if (oldRiverDirection==8)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
			//	constructor2Error.value += "\nhard right";
			}
			else if (directionOkay[directionStraight] == 0 && oldRiverDirection == directionStraight && directionOkay[directionHardLeft] == 1 && directionOkay[directionHardRight] == 1 && thisIsLava == 0)
			{
				randomNumber = Math.floor(Math.random()*100)+1;
				if (randomNumber < 51)
				{
					//	go hard left
					if (oldRiverDirection==1)			{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
					else if (oldRiverDirection==2)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
					else if (oldRiverDirection==3)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
					else if (oldRiverDirection==4)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
					else if (oldRiverDirection==5)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
					else if (oldRiverDirection==6)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
					else if (oldRiverDirection==7)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
					else if (oldRiverDirection==8)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
				//	constructor2Error.value += "\nhard left";
				}
				else
				{
					//	go hard right
					if (oldRiverDirection==1)			{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
					else if (oldRiverDirection==2)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
					else if (oldRiverDirection==3)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
					else if (oldRiverDirection==4)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
					else if (oldRiverDirection==5)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
					else if (oldRiverDirection==6)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
					else if (oldRiverDirection==7)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
					else if (oldRiverDirection==8)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
				//	constructor2Error.value += "\nhard right";
				}
			}

//	1	2	3

//	4		5

//	6	7	8

/*
			else if (directionOkay[directionStraight] == 0 && oldRiverDirection == directionStraight && directionOkay[directionBackLeft] == 1 && directionOkay[directionBackRight] == 0 && thisIsLava == 0)
			{
				//	go back left
				if (oldRiverDirection==1)			{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
				else if (oldRiverDirection==2)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
				else if (oldRiverDirection==3)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
				else if (oldRiverDirection==4)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
				else if (oldRiverDirection==5)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
				else if (oldRiverDirection==6)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
				else if (oldRiverDirection==7)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
				else if (oldRiverDirection==8)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
			//	constructor2Error.value += "\nback left";
			}
			else if (directionOkay[directionStraight] == 0 && oldRiverDirection == directionStraight && directionOkay[directionBackLeft] == 0 && directionOkay[directionBackRight] == 1 && thisIsLava == 0)
			{
				//	go back right
				if (oldRiverDirection==1)			{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
				else if (oldRiverDirection==2)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
				else if (oldRiverDirection==3)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
				else if (oldRiverDirection==4)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
				else if (oldRiverDirection==5)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
				else if (oldRiverDirection==6)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
				else if (oldRiverDirection==7)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
				else if (oldRiverDirection==8)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
			//	constructor2Error.value += "\nback right";
			}
			else if (directionOkay[directionStraight] == 0 && oldRiverDirection == directionStraight && directionOkay[directionBackLeft] == 1 && directionOkay[directionBackRight] == 1 && thisIsLava == 0)
			{
				randomNumber = Math.floor(Math.random()*100)+1;
				if (randomNumber < 51)
				{
					//	go back left
					if (oldRiverDirection==1)			{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
					else if (oldRiverDirection==2)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
					else if (oldRiverDirection==3)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
					else if (oldRiverDirection==4)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
					else if (oldRiverDirection==5)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
					else if (oldRiverDirection==6)		{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
					else if (oldRiverDirection==7)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
					else if (oldRiverDirection==8)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
				//	constructor2Error.value += "\nback left";
				}
				else
				{
					//	go back right
					if (oldRiverDirection==1)			{riverX = riverX + 1; riverY = riverY; oldRiverDirection = 5;}
					else if (oldRiverDirection==2)		{riverX = riverX + 1; riverY = riverY + 1; oldRiverDirection = 8;}
					else if (oldRiverDirection==3)		{riverX = riverX; riverY = riverY + 1; oldRiverDirection = 7;}
					else if (oldRiverDirection==4)		{riverX = riverX + 1; riverY = riverY - 1; oldRiverDirection = 3;}
					else if (oldRiverDirection==5)		{riverX = riverX - 1; riverY = riverY + 1; oldRiverDirection = 6;}
					else if (oldRiverDirection==6)		{riverX = riverX; riverY = riverY - 1; oldRiverDirection = 2;}
					else if (oldRiverDirection==7)		{riverX = riverX - 1; riverY = riverY - 1; oldRiverDirection = 1;}
					else if (oldRiverDirection==8)		{riverX = riverX - 1; riverY = riverY; oldRiverDirection = 4;}
				//	constructor2Error.value += "\nback right";
				}
			}
*/

			else
			{
			//	constructor2Error.value += "\ndead end";
				riverEnd = 1;
			}

			if (riverX < 1)
			{
				riverX = mapSizeX;
			}
			if (riverX > mapSizeX)
			{
				riverX = 1;
			}
			if (riverY < 1)
			{
				riverY = mapSizeY;
			}
			if (riverY > mapSizeY)
			{
				riverY = 1;
			}

			if (mapArrayDev[riverX][riverY] == 0.6 ||
			    mapArrayDev[riverX][riverY] == 0.7 ||
			    mapArrayDev[riverX][riverY] == 0.8 ||
			    mapArrayDev[riverX][riverY] == 0.9)
			{
			//	constructor2Error.value += "\nRunning through lava at ["+riverX+"]["+riverY+"]! River end!";
			//	constructor2Error.scrollTop = constructor2Error.scrollHeight;
				riverEnd = 1;
			}

			plotRiver();
//			newPlotRiver3();
		}
	}
}

function showLavaFlows()
{
	lavaFlowsTextArea.value=lavaFlowsSlider.value;
}

function showRivers()
{
	riversTextArea.value=riversSlider.value;
}

</script>

</head>

<body onLoad="main();">

<!--	CONSTRUCTOR STAGE 2DIV		#####################################################################################################	-->

<div id='divConstructorStage2' style='display:none;'>

<canvas id='waterMapDisplay' border='1' style='position:absolute; top:10px; left:370px;'></canvas>

<table>

	<!--	WATER LEVEL	-->
	<tr>
		<td><BUTTON TYPE='button' id='buttonChangeWaterLevel' class='btn' onClick='changeWaterLevel();' style='width:100px; height:20px;'>Set Water Level</button></td>
		<td><input id='waterLevelSlider' onInput='showWaterLevel();' type='range' min='1' max='31' value=14 step='1'></td>
		<td><textarea id='waterLevelTextArea' style='width:50px; height:20px;'>14</textarea></td>
		<td>&nbsp;</td>
	</tr>

			<!--	SHALLOWS	-->
		<!--		<tr>	-->
		<!--			<td><BUTTON TYPE='button' id='buttonAddShallows' class='btn' onClick='doAddShallows=1;' style='width:100px; height:20px;'>Add Shallows</button></td>	-->
		<!--			<td><input id='addShallowsSlider' onInput='showNumShallows();' type='range' min='0' max='10' value='1' step='1'></td>	-->
		<!--			<td><textarea id='addShallowsTextArea' style='width:50px; height:20px;'>1</textarea></td>	-->
		<!--			<td>Tiles Deep</td>	-->
		<!--		</tr>	-->

			<!--	MID DEPTHS	-->
		<!--		<tr>	-->
		<!--			<td><BUTTON TYPE='button' id='buttonAddMids' class='btn' onClick='addMids();' style='width:100px; height:20px;'>Add Mid Depths</button></td>	-->
		<!--			<td><input id='addMidsSlider' onInput='showNumMids();' type='range' min='0' max='10' value='1' step='1'></td>	-->
		<!--			<td><textarea id='addShallowsTextArea' style='width:50px; height:20px;'>1</textarea></td>	-->
		<!--			<td>Tiles Deep</td>	-->
		<!--		</tr>	-->

	<!--	BEACHES	-->
	<tr>
		<td>Beach Density</td>
		<td><input id='beachDensitySlider' onInput='showBeachDensity();' type='range' min='1' max='100' value=50 step='1'></td>
		<td><textarea id='beachDensityTextArea' style='width:50px; height:20px;'>50</textarea></td>
		<td>%</td>
	</tr>

	<!--	BEACHES	DENSITY	-->
	<tr>
		<td><BUTTON TYPE='button' id='buttonAddBeaches' class='btn' onClick='doAddBeaches=1;' style='width:100px; height:20px;'>Add Beaches</button></td>
		<td><input id='beachRadiusSlider' onInput='showBeachRadius();' type='range' min='0' max='10' value=1 step='1'></td>
		<td><textarea id='beachRadiusTextArea' style='width:50px; height:20px;'>1</textarea></td>
		<td>Tiles Deep</td>
	</tr>

	<!--	RIVER / LAVA WIDTH	-->
	<tr>
		<td>River / Lava Width</td>
		<td><button type='button' id='buttonRiversRegular' onClick='riversRegular=1; changeRiverWidth();' style='margin:0; border:0; padding:0; height:20px; width:22px; background:url(checked.png);'></button></td>
		<td>Regular</td>
		<td>&nbsp;</td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td><button type='button' id='buttonRiversWide' onClick='riversRegular=0; changeRiverWidth();' style='margin:0; border:0; padding:0; height:20px; width:22px; background:url(unchecked.png);'></button></td>
		<td>Wide</td>
		<td>&nbsp;</td>
	</tr>

	<!--	LAVA CURVYNESS	-->
	<tr>
		<td>Lava Curvyness</td>
		<td><input id='lavaCurvynessSlider' onInput='showLavaCurvyness();' type='range' min='1' max='100' value=35 step='1'></td>
		<td><textarea id='lavaCurvynessTextArea' style='width:50px; height:20px;'>35</textarea></td>
		<td>% Curvy</td>
	</tr>

	<!--	ADD LAVA FLOWS	-->
	<tr>
		<td><BUTTON TYPE='button' id='buttonAddLavaFlows' class='btn' onClick='doAddLavaFlows=1;' style='width:100px; height:20px;'>Add Lava Flows</button></td>
		<td><input id='lavaFlowsSlider' onInput='showLavaFlows();' type='range' min='1' max='100' value=50 step='1'></td>
		<td><textarea id='lavaFlowsTextArea' style='width:50px; height:20px;'>50</textarea></td>
		<td>Flows</td>
	</tr>

	<!--	RIVER CURVYNESS	-->
	<tr>
		<td>River Curvyness</td>
		<td><input id='riverCurvynessSlider' onInput='showRiverCurvyness();' type='range' min='1' max='100' value=50 step='1'></td>
		<td><textarea id='riverCurvynessTextArea' style='width:50px; height:20px;'>50</textarea></td>
		<td>% Curvy</td>
	</tr>

	<!--	ADD RIVERS	-->
	<tr>
		<td><BUTTON TYPE='button' id='buttonAddRivers' class='btn' onClick='doAddRivers=1;' style='width:100px; height:20px;'>Add Rivers</button></td>
		<td><input id='riversSlider' onInput='showRivers();' type='range' min='1' max='100' value=50 step='1'></td>
		<td><textarea id='riversTextArea' style='width:50px; height:20px;'>50</textarea></td>
		<td>Rivers</td>
	</tr>

	<!--	ERASE CHANGES	-->
	<tr>
		<td><BUTTON TYPE='button' id='buttonEraseChanges' class='btn' onClick='eraseMods=1;changeWaterLevel();' style='width:100px; height:20px;'>Erase Changes</button></td>
		<!--	<td><BUTTON TYPE='button' id='buttonEraseChanges' class='btn' onClick='eraseMods=1;changeWaterLevel();' style='position:absolute; font-family:Arial; font-weight:bold; font-size:14px; color:darkblue; top:"+masterTop+"px; left:"+stage2Left+"px; width:140px; height:30px; display:block;'>Erase Changes</button></td>	-->
	</tr>
</table>

&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>

	<textarea id='constructor2Error' style='width:360px; height:500px; color:darkblue; font-size:10px;'></textarea>

</div>

<!--	CONSTRUCTOR DIV		#####################################################################################################	-->

<div id='divConstructor' style='display:none;'>
	<textarea id='constructorError' style='position:absolute; top:10px; left:10px; height:500px; width:300px; color:darkblue; font-family:Arial; font-size:9px;'></textarea>
	<BUTTON TYPE='button' id='buttonContinueFromConstructor' Value='Continue' class='btn' onClick='continueFromConstructor()' style='position:absolute; top:520px; left:10px; width:300px; height:40px; input:disabled; display:none;'>Continue</button>
	<canvas id='worldMapDisplay' border='1' style='position:absolute; top:10px; left:320px;'></canvas>
</div>

<!--	BUILDER DIV		#####################################################################################################	-->

<div id='divBuilder' style='display:block;'>

<!--	PRESETS	-->

<table>
	<tr>
		<td>PRESETS:</td>
		<td>
			<table>
				<tr>
					<td><BUTTON TYPE='button' id='buttonSetPreset' Value='Set' class='btn' onClick='setPreset()' style='width:80px; height:20px;'>Set</button></td>

					<td><BUTTON TYPE='button' id='buttonCancelSetPreset' Value='Cancel' class='btn' onClick='cancelSetPreset()' style='width:80px; height:20px; input:disabled;'>Cancel</button></td>
					<td><BUTTON TYPE='button' id='buttonPreset1' Value='Preset 1' class='btn' onClick='activePreset = 1; setThePreset();' style='width:80px; height:20px;'>Preset 1</button></td>
					<td><BUTTON TYPE='button' id='buttonPreset2' Value='Preset 2' class='btn' onClick='activePreset = 2; setThePreset();' style='width:80px; height:20px;'>Preset 2</button></td>
					<td><BUTTON TYPE='button' id='buttonPreset3' Value='Preset 3' class='btn' onClick='activePreset = 3; setThePreset();' style='width:80px; height:20px;'>Preset 3</button></td>
					<td style='width:50px;'></td>

			<!--	DRAW / ERASE LAND	-->

					<td><BUTTON TYPE='button' id='buttonDrawLand' class='btn' onClick='toggleDrawLand()' style='width:80px; height:20px;'>Draw Land</button></td>
					<td><BUTTON TYPE='button' id='buttonEraseLand' class='btn' onClick='toggleEraseLand()' style='width:80px; height:20px;'>Erase Land</button></td>

			<!--	BRUSH SIZE	-->

					<td style='text-align:right;'>Brush Size:</td>
					<td><input id='brushSizeSlider' onInput='showBrushSize();' type='range' min='1' max='21' value='1' step='2'></td>
					<td><textarea id='brushSizeTextArea' style='resize:none; height:20px; width:50px;'>1</textarea></td>
					<td>Tiles</td>
				</tr>

				<tr>
					<td><BUTTON TYPE='button' id='buttonRestorePreset' Value='Restore' class='btn' onClick='restorePreset()' style='width:80px; height:20px;'>Restore</button></td>
					<td><BUTTON TYPE='button' id='buttonCancelRestorePreset' Value='Cancel' class='btn' onClick='cancelRestorePreset()' style='width:80px; height:20px;'>CANCEL</button></td>

					<td><BUTTON TYPE='button' id='buttonPreset4' Value='Preset 4' class='btn' onClick='activePreset = 4; setThePreset();' style='width:80px; height:20px;'>Preset 4</button></td>
					<td><BUTTON TYPE='button' id='buttonPreset5' Value='Preset 5' class='btn' onClick='activePreset = 5; setThePreset();' style='width:80px; height:20px;'>Preset 5</button></td>
					<td><BUTTON TYPE='button' id='buttonPreset6' Value='Preset 6' class='btn' onClick='activePreset = 6; setThePreset();' style='width:80px; height:20px;'>Preset 6</button></td>
					<td>&nbsp;&nbsp;&nbsp;</td>

				<!--	SELECT / CLEAR ALL	-->

					<td><BUTTON TYPE='button' id='buttonSelectAll' Value='Plot Land' class='btn' onClick='selectAll()' style='width:80px; height:20px;'>Select All</button></td>
					<td><BUTTON TYPE='button' id='buttonClearAll' Value='Plot Land' class='btn' onClick='clearAll()' style='width:80px; height:20px;'>Clear All</button></td>

				<!--	RANDOM LAND	-->

					<td><BUTTON TYPE='button' id='buttonRandomLand' Value='Plot Land' class='btn' onClick='createRandomLand()' style='width:80px; height:20px;'>Random</button></td>

					<td><input id='randomLandSlider' onInput='showRandomLand();' type='range' min='1' max='100' value='30' step='1'></td>
					<td><textarea id='randomLandTextArea' style='resize:none; height:20px; width:50px;'>30</textarea></td>
					<td>% Land</td>
				</tr>
			</table>
		</td>
	</tr>
</table>

<table>
	<tr>
		<td>
			<table>
					<!--	WORLD WIDTH	-->
				<tr>
					<td>World Width:</td>
					<td><input id='widthSlider' onInput='showWidth();' type='range' min='1000' max='10000' value='1000' step='1000'></td>
					<td><textarea id='widthTextArea' style='resize:none; width:50px; height:20px;'>1000</textarea></td>
					<td>Tiles Wide</td>
				</tr>

					<!--	WORLD HEIGHT	-->
				<tr>
					<td>World Height:</td>
					<td><input id='heightSlider' onInput='showHeight();' type='range' min='1000' max='10000' value='1000' step='1000'></td>
					<td><textarea id='heightTextArea' style='resize:none; width:50px; height:20px;'>1000</textarea></td>
					<td>Tiles High</td>
				</tr>

					<!--	# OF MOUNTAIN RANGES	-->
				<tr>
					<td># of Mountain Ranges:</td>
					<td><input id='numMtnRangesSlider' onInput='showNumMtnRanges();' type='range' min='0' max='100' value='30' step='1'></td>
					<td><textarea id='numMtnRangesTextArea' style='resize:none; width:50px; height:20px;'>30</textarea></td>
					<td>Mountains</td>
				</tr>

					<!--	MAX MOUNTAIN RANGE LENGTH	-->
				<tr>
					<td>Max Mountain Range Length:</td>
					<td><input id='maxMtnLengthSlider' onInput='showMaxMtnLength();' type='range' min='1' max='100' value='10' step='1'></td>
					<td><textarea id='maxMtnLengthTextArea' style='resize:none; width:50px; height:20px;'>10</textarea></td>
					<td>% of Map</td>
				</tr>

					<!--	MAX MOUNTAIN RANGE GIRTH	-->
				<tr>
					<td>Max Mountain Range Girth:</td>
					<td><input id='maxMtnGirthSlider' onInput='showMaxMtnGirth();' top='500px' type='range' min='1' max='21' value='1' step='1'></td>
					<td><textarea id='maxMtnGirthTextArea' style='resize:none; width:50px; height:20px;'>1</textarea></td>
					<td>Tiles</td>
				</tr>

					<!--	# OF HILL RANGES	-->
				<tr>
					<td># of Hill Ranges per Level:</td>
					<td><input id='numHillRangesSlider' onInput='showNumHillRanges();' top='500px' type='range' min='0' max='200' value='25' step='1'></td>
					<td><textarea id='numHillRangesTextArea' style='resize:none; width:50px; height:20px;'>25</textarea></td>
					<td>Hills</td>
				</tr>

					<!--	MAX HILL RANGE LENGTH	-->
				<tr>
					<td>Max Hill Range Length:</td>
					<td><input id='maxHillLengthSlider' onInput='showMaxHillLength();' top='500px' type='range' min='1' max='100' value='10' step='1'></td>
					<td><textarea id='maxHillLengthTextArea' style='resize:none; width:50px; height:20px;'>10</textarea></td>
					<td>% of Map</td>
				</tr>

					<!--	MAX HILL RANGE GIRTH	-->
				<tr>
					<td>Max Hill Range Girth:</td>
					<td><input id='maxHillGirthSlider' onInput='showMaxHillGirth();' top='500px' type='range' min='1' max='21' value='3' step='1'></td>
					<td><textarea id='maxHillGirthTextArea' style='resize:none; width:50px; height:20px;'>3</textarea></td>
					<td>Tiles</td>
				</tr>

					<!--	HILL RANGE CURVYNESS	-->
				<tr>
					<td>Hill Range Curvyness:</td>
					<td><input id='hillCurvynessSlider' onInput='showHillCurvyness();' top='500px' type='range' min='0' max='100' value='80' step='1'></td>
					<td><textarea id='hillCurvynessTextArea' style='resize:none; width:50px; height:20px;'>80</textarea></td>
					<td>% Curvy</td>
				</tr>

					<!--	CONFINE HILLS	-->
				<tr>
					<td>Confine hills to selected areas:</td>
					<td><button type='button' id='hillsConfined' onClick='hillsConfined();' style='margin:0; border:0; padding:0; height:20px; width:22px; background:url(checked.png);'></button></td>
				<!--	document.getElementById("hillsConfined").style.background="url(checked.png) no-repeat";	-->
				</tr>

					<!--	HILLS ARE WILD AND FREE	-->
				<tr>
					<td>Let the hills run wild and free:</td>
					<td><button type='button' id='hillsWild' onClick='hillsWild();' style='margin:0; border:0; padding:0; height:20px; width:22px; background:url(unchecked.png);'></button></td>
				</tr>

					<!--	LAND SLOPE SPREAD	-->
				<tr>
					<td>Land Slope Spread:</td>
					<td><input id='landSlopeSlider' onInput='showLandSlope();' top='500px' type='range' min='101' max='200' value='114' step='1'></td>
					<td><textarea id='landSlopeTextArea' style='resize:none; width:50px; height:20px;'>114</textarea></td>
					<td>% Spread</td>
				</tr>

					<!--	# OF VOLCANOES	-->
				<tr>
					<td># of Volcanoes:</td>
					<td><input id='numVolcanoesSlider' onInput='showNumVolcanoes();' top='500px' type='range' min='0' max='100' value='8' step='1'></td>
					<td><textarea id='numVolcanoesTextArea' style='resize:none; width:50px; height:20px;'>8</textarea></td>
					<td>Volcanoes</td>
				</tr>

					<!--	MAX VOLCANO SIZE	-->
				<tr>
					<td>Max Volcano Size:</td>
					<td><input id='maxVolcanoSizeSlider' onInput='showMaxVolcanoSize();' top='500px' type='range' min='4' max='100' value='8' step='1'></td>
					<td><textarea id='maxVolcanoSizeTextArea' style='resize:none; width:50px; height:20px;'>8</textarea></td>
					<td>Tiles</td>
				</tr>

					<!--	LAND MASS UNIFORMITY	-->
				<tr>
					<td>Land Mass Uniformity:</td>
					<td><input id='landUniformitySlider' onInput='showLandUniformity();' top='500px' type='range' min='1' max='100' value='25' step='1'></td>
					<td><textarea id='landUniformityTextArea' style='resize:none; width:50px; height:20px;'>25</textarea></td>
					<td>% Uniformity</td>
				</tr>
			</table>
		</td>
		<td>
		</td>
	</tr>
</table>

<!--	SLOPE DISPLAY	-->

	<font>Mountain Slope Contour:</font>
	<canvas id='slopeDisplay' border='0' width='500' height='30' top='600' style='position:relative; top:50px;'>Your browser does not support the HTML5 canvas tag.</canvas><br>

<!--	BUILDER ERROR FIELD	-->

	<textarea id='builderError' style='width:500px; height:200px; color:darkblue; font-size:10px;'>This is BuilderError!</textarea>

<!--	<img src='exclamation20.png' id='exclamationWidth' style='position:relative; top:10px; left:15px; display:none;'>	-->




<!--		<img src='exclamation20.png' id='exclamationHeight' style='position:relative; top:10px; left:15px; display:none;'>	-->

	<!--	SET UP 10000 CHECK BOXES	-->

			<div id='checkboxDiv' style='position:absolute; top:80px; left:520px;'>
			</div>

<!--	BUTTON BUILD WORLD	-->

	<BUTTON TYPE='button' id='run' Value='Plot Land' class='btn' onClick='doBuildWorld=1' style='position:absolute; top:590px; left:600px; font-family:Arial; font-weight:bold; font-size:36px; color:darkblue; width:350px; height:80px;'>BUILD WORLD</button>

	</font>
	</div>

	<script>

	</script>

</body>
</html>